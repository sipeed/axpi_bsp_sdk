(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ax2"],{"04d1":function(e,t,n){var r=n("342f"),i=r.match(/firefox\/(\d+)/i);e.exports=!!i&&+i[1]},"0b25":function(e,t,n){var r=n("da84"),i=n("5926"),a=n("50c4"),o=r.RangeError;e.exports=function(e){if(void 0===e)return 0;var t=i(e),n=a(t);if(t!==n)throw o("Wrong length or index");return n}},"0cb2":function(e,t,n){var r=n("e330"),i=n("7b0b"),a=Math.floor,o=r("".charAt),s=r("".replace),c=r("".slice),u=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,f,d){var p=n+e.length,h=r.length,m=l;return void 0!==f&&(f=i(f),m=u),s(d,m,(function(i,s){var u;switch(o(s,0)){case"$":return"$";case"&":return e;case"`":return c(t,0,n);case"'":return c(t,p);case"<":u=f[c(s,1,-1)];break;default:var l=+s;if(0===l)return i;if(l>h){var d=a(l/10);return 0===d?i:d<=h?void 0===r[d-1]?o(s,1):r[d-1]+o(s,1):i}u=r[l-1]}return void 0===u?"":u}))}},1448:function(e,t,n){var r=n("dfb9"),i=n("b6b7");e.exports=function(e,t){return r(i(e),t)}},"145e":function(e,t,n){"use strict";var r=n("7b0b"),i=n("23cb"),a=n("07fa"),o=Math.min;e.exports=[].copyWithin||function(e,t){var n=r(this),s=a(n),c=i(e,s),u=i(t,s),l=arguments.length>2?arguments[2]:void 0,f=o((void 0===l?s:i(l,s))-u,s-c),d=1;u<c&&c<u+f&&(d=-1,u+=f-1,c+=f-1);while(f-- >0)u in n?n[c]=n[u]:delete n[c],c+=d,u+=d;return n}},"14c3":function(e,t,n){var r=n("da84"),i=n("c65b"),a=n("825a"),o=n("1626"),s=n("c6b6"),c=n("9263"),u=r.TypeError;e.exports=function(e,t){var n=e.exec;if(o(n)){var r=i(n,e,t);return null!==r&&a(r),r}if("RegExp"===s(e))return i(c,e,t);throw u("RegExp#exec called on incompatible receiver")}},"159b":function(e,t,n){var r=n("da84"),i=n("fdbc"),a=n("785a"),o=n("17c2"),s=n("9112"),c=function(e){if(e&&e.forEach!==o)try{s(e,"forEach",o)}catch(t){e.forEach=o}};for(var u in i)i[u]&&c(r[u]&&r[u].prototype);c(a)},"170b":function(e,t,n){"use strict";var r=n("ebb5"),i=n("50c4"),a=n("23cb"),o=n("b6b7"),s=r.aTypedArray,c=r.exportTypedArrayMethod;c("subarray",(function(e,t){var n=s(this),r=n.length,c=a(e,r),u=o(n);return new u(n.buffer,n.byteOffset+c*n.BYTES_PER_ELEMENT,i((void 0===t?r:a(t,r))-c))}))},"17c2":function(e,t,n){"use strict";var r=n("b727").forEach,i=n("a640"),a=i("forEach");e.exports=a?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},"182d":function(e,t,n){var r=n("da84"),i=n("f8cd"),a=r.RangeError;e.exports=function(e,t){var n=i(e);if(n%t)throw a("Wrong offset");return n}},"1bf2":function(e,t,n){var r=n("23e7"),i=n("56ef");r({target:"Reflect",stat:!0},{ownKeys:i})},"219c":function(e,t,n){"use strict";var r=n("da84"),i=n("e330"),a=n("d039"),o=n("59ed"),s=n("addb"),c=n("ebb5"),u=n("04d1"),l=n("d998"),f=n("2d00"),d=n("512ce"),p=r.Array,h=c.aTypedArray,m=c.exportTypedArrayMethod,y=r.Uint16Array,g=y&&i(y.prototype.sort),v=!!g&&!(a((function(){g(new y(2),null)}))&&a((function(){g(new y(2),{})}))),b=!!g&&!a((function(){if(f)return f<74;if(u)return u<67;if(l)return!0;if(d)return d<602;var e,t,n=new y(516),r=p(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(g(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==r[e])return!0})),_=function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!==n?-1:t!==t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}};m("sort",(function(e){return void 0!==e&&o(e),b?g(this,e):s(h(this),_(e))}),!b||v)},"21a6":function(e,t,n){(function(n){var r,i,a;(function(n,o){i=[],r=o,a="function"===typeof r?r.apply(t,i):r,void 0===a||(e.exports=a)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function r(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){c(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,s=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,t,n){var s=o.URL||o.webkitURL,c=document.createElement("a");t=t||e.name||"download",c.download=t,c.rel="noopener","string"==typeof e?(c.href=e,c.origin===location.origin?a(c):i(c.href)?r(e,t,n):a(c,c.target="_blank")):(c.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(c.href)}),4e4),setTimeout((function(){a(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,o){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,o),n);else if(i(e))r(e,n,o);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){a(s)}))}}:function(e,t,n,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return r(e,t,n);var a="application/octet-stream"===e.type,c=/constructor/i.test(o.HTMLElement)||o.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||a&&c||s)&&"undefined"!=typeof FileReader){var l=new FileReader;l.onloadend=function(){var e=l.result;e=u?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},l.readAsDataURL(e)}else{var f=o.URL||o.webkitURL,d=f.createObjectURL(e);i?i.location=d:location.href=d,i=null,setTimeout((function(){f.revokeObjectURL(d)}),4e4)}});o.saveAs=c.saveAs=c,e.exports=c}))}).call(this,n("c8ba"))},"25a1":function(e,t,n){"use strict";var r=n("ebb5"),i=n("d58f").right,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("reduceRight",(function(e){var t=arguments.length;return i(a(this),e,t,t>1?arguments[1]:void 0)}))},"25f0":function(e,t,n){"use strict";var r=n("e330"),i=n("5e77").PROPER,a=n("6eeb"),o=n("825a"),s=n("3a9b"),c=n("577e"),u=n("d039"),l=n("ad6d"),f="toString",d=RegExp.prototype,p=d[f],h=r(l),m=u((function(){return"/a/b"!=p.call({source:"a",flags:"b"})})),y=i&&p.name!=f;(m||y)&&a(RegExp.prototype,f,(function(){var e=o(this),t=c(e.source),n=e.flags,r=c(void 0===n&&s(d,e)&&!("flags"in d)?h(e):n);return"/"+t+"/"+r}),{unsafe:!0})},2954:function(e,t,n){"use strict";var r=n("ebb5"),i=n("b6b7"),a=n("d039"),o=n("f36a"),s=r.aTypedArray,c=r.exportTypedArrayMethod,u=a((function(){new Int8Array(1).slice()}));c("slice",(function(e,t){var n=o(s(this),e,t),r=i(this),a=0,c=n.length,u=new r(c);while(c>a)u[a]=n[a++];return u}),u)},3280:function(e,t,n){"use strict";var r=n("ebb5"),i=n("2ba4"),a=n("e58c"),o=r.aTypedArray,s=r.exportTypedArrayMethod;s("lastIndexOf",(function(e){var t=arguments.length;return i(a,o(this),t>1?[e,arguments[1]]:[e])}))},3410:function(e,t,n){var r=n("23e7"),i=n("d039"),a=n("7b0b"),o=n("e163"),s=n("e177"),c=i((function(){o(1)}));r({target:"Object",stat:!0,forced:c,sham:!s},{getPrototypeOf:function(e){return o(a(e))}})},"3a7b":function(e,t,n){"use strict";var r=n("ebb5"),i=n("b727").findIndex,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("findIndex",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0)}))},"3c5d":function(e,t,n){"use strict";var r=n("da84"),i=n("ebb5"),a=n("07fa"),o=n("182d"),s=n("7b0b"),c=n("d039"),u=r.RangeError,l=i.aTypedArray,f=i.exportTypedArrayMethod,d=c((function(){new Int8Array(1).set({})}));f("set",(function(e){l(this);var t=o(arguments.length>1?arguments[1]:void 0,1),n=this.length,r=s(e),i=a(r),c=0;if(i+t>n)throw u("Wrong length");while(c<i)this[t+c]=r[c++]}),d)},"3fcc":function(e,t,n){"use strict";var r=n("ebb5"),i=n("b727").map,a=n("b6b7"),o=r.aTypedArray,s=r.exportTypedArrayMethod;s("map",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(a(e))(t)}))}))},"408a":function(e,t,n){var r=n("e330");e.exports=r(1..valueOf)},"466d":function(e,t,n){"use strict";var r=n("c65b"),i=n("d784"),a=n("825a"),o=n("50c4"),s=n("577e"),c=n("1d80"),u=n("dc4a"),l=n("8aa5"),f=n("14c3");i("match",(function(e,t,n){return[function(t){var n=c(this),i=void 0==t?void 0:u(t,e);return i?r(i,t,n):new RegExp(t)[e](s(n))},function(e){var r=a(this),i=s(e),c=n(t,r,i);if(c.done)return c.value;if(!r.global)return f(r,i);var u=r.unicode;r.lastIndex=0;var d,p=[],h=0;while(null!==(d=f(r,i))){var m=s(d[0]);p[h]=m,""===m&&(r.lastIndex=l(i,o(r.lastIndex),u)),h++}return 0===h?null:p}]}))},"4a9b":function(e,t,n){var r=n("74e8");r("Float64",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},"4e82":function(e,t,n){"use strict";var r=n("23e7"),i=n("e330"),a=n("59ed"),o=n("7b0b"),s=n("07fa"),c=n("577e"),u=n("d039"),l=n("addb"),f=n("a640"),d=n("04d1"),p=n("d998"),h=n("2d00"),m=n("512ce"),y=[],g=i(y.sort),v=i(y.push),b=u((function(){y.sort(void 0)})),_=u((function(){y.sort(null)})),w=f("sort"),E=!u((function(){if(h)return h<70;if(!(d&&d>3)){if(p)return!0;if(m)return m<603;var e,t,n,r,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)y.push({k:t+r,v:n})}for(y.sort((function(e,t){return t.v-e.v})),r=0;r<y.length;r++)t=y[r].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}})),C=b||!_||!w||!E,T=function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:c(t)>c(n)?1:-1}};r({target:"Array",proto:!0,forced:C},{sort:function(e){void 0!==e&&a(e);var t=o(this);if(E)return void 0===e?g(t):g(t,e);var n,r,i=[],c=s(t);for(r=0;r<c;r++)r in t&&v(i,t[r]);l(i,T(e)),n=i.length,r=0;while(r<n)t[r]=i[r++];while(r<c)delete t[r++];return t}})},"512ce":function(e,t,n){var r=n("342f"),i=r.match(/AppleWebKit\/(\d+)\./);e.exports=!!i&&+i[1]},5319:function(e,t,n){"use strict";var r=n("2ba4"),i=n("c65b"),a=n("e330"),o=n("d784"),s=n("d039"),c=n("825a"),u=n("1626"),l=n("5926"),f=n("50c4"),d=n("577e"),p=n("1d80"),h=n("8aa5"),m=n("dc4a"),y=n("0cb2"),g=n("14c3"),v=n("b622"),b=v("replace"),_=Math.max,w=Math.min,E=a([].concat),C=a([].push),T=a("".indexOf),S=a("".slice),I=function(e){return void 0===e?e:String(e)},k=function(){return"$0"==="a".replace(/./,"$0")}(),A=function(){return!!/./[b]&&""===/./[b]("a","$0")}(),R=!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));o("replace",(function(e,t,n){var a=A?"$":"$0";return[function(e,n){var r=p(this),a=void 0==e?void 0:m(e,b);return a?i(a,e,r,n):i(t,d(r),e,n)},function(e,i){var o=c(this),s=d(e);if("string"==typeof i&&-1===T(i,a)&&-1===T(i,"$<")){var p=n(t,o,s,i);if(p.done)return p.value}var m=u(i);m||(i=d(i));var v=o.global;if(v){var b=o.unicode;o.lastIndex=0}var k=[];while(1){var A=g(o,s);if(null===A)break;if(C(k,A),!v)break;var R=d(A[0]);""===R&&(o.lastIndex=h(s,f(o.lastIndex),b))}for(var x="",O=0,F=0;F<k.length;F++){A=k[F];for(var P=d(A[0]),D=_(w(l(A.index),s.length),0),U=[],L=1;L<A.length;L++)C(U,I(A[L]));var M=A.groups;if(m){var N=E([P],U,D,s);void 0!==M&&C(N,M);var B=d(r(i,void 0,N))}else B=y(P,s,D,U,M,i);D>=O&&(x+=S(s,O,D)+B,O=D+P.length)}return x+S(s,O)}]}),!R||!k||A)},5377:function(e,t,n){var r=n("83ab"),i=n("9bf2"),a=n("ad6d"),o=n("d039"),s=RegExp.prototype,c=r&&o((function(){return"sy"!==Object.getOwnPropertyDescriptor(s,"flags").get.call({dotAll:!0,sticky:!0})}));c&&i.f(s,"flags",{configurable:!0,get:a})},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var r=n("e330"),i=n("1d80"),a=n("577e"),o=n("5899"),s=r("".replace),c="["+o+"]",u=RegExp("^"+c+c+"*"),l=RegExp(c+c+"*$"),f=function(e){return function(t){var n=a(i(t));return 1&e&&(n=s(n,u,"")),2&e&&(n=s(n,l,"")),n}};e.exports={start:f(1),end:f(2),trim:f(3)}},"5cc6":function(e,t,n){var r=n("74e8");r("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},"5f96":function(e,t,n){"use strict";var r=n("ebb5"),i=n("e330"),a=r.aTypedArray,o=r.exportTypedArrayMethod,s=i([].join);o("join",(function(e){return s(a(this),e)}))},"60bd":function(e,t,n){"use strict";var r=n("da84"),i=n("e330"),a=n("5e77").PROPER,o=n("ebb5"),s=n("e260"),c=n("b622"),u=c("iterator"),l=r.Uint8Array,f=i(s.values),d=i(s.keys),p=i(s.entries),h=o.aTypedArray,m=o.exportTypedArrayMethod,y=l&&l.prototype[u],g=!!y&&"values"===y.name,v=function(){return f(h(this))};m("entries",(function(){return p(h(this))})),m("keys",(function(){return d(h(this))})),m("values",v,a&&!g),m(u,v,a&&!g)},"621a":function(e,t,n){"use strict";var r=n("da84"),i=n("e330"),a=n("83ab"),o=n("a981"),s=n("5e77"),c=n("9112"),u=n("e2cc"),l=n("d039"),f=n("19aa"),d=n("5926"),p=n("50c4"),h=n("0b25"),m=n("77a7"),y=n("e163"),g=n("d2bb"),v=n("241c").f,b=n("9bf2").f,_=n("81d5"),w=n("4dae"),E=n("d44e"),C=n("69f3"),T=s.PROPER,S=s.CONFIGURABLE,I=C.get,k=C.set,A="ArrayBuffer",R="DataView",x="prototype",O="Wrong length",F="Wrong index",P=r[A],D=P,U=D&&D[x],L=r[R],M=L&&L[x],N=Object.prototype,B=r.Array,H=r.RangeError,j=i(_),V=i([].reverse),G=m.pack,z=m.unpack,W=function(e){return[255&e]},q=function(e){return[255&e,e>>8&255]},Y=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},$=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},K=function(e){return G(e,23,4)},J=function(e){return G(e,52,8)},X=function(e,t){b(e[x],t,{get:function(){return I(this)[t]}})},Q=function(e,t,n,r){var i=h(n),a=I(e);if(i+t>a.byteLength)throw H(F);var o=I(a.buffer).bytes,s=i+a.byteOffset,c=w(o,s,s+t);return r?c:V(c)},Z=function(e,t,n,r,i,a){var o=h(n),s=I(e);if(o+t>s.byteLength)throw H(F);for(var c=I(s.buffer).bytes,u=o+s.byteOffset,l=r(+i),f=0;f<t;f++)c[u+f]=l[a?f:t-f-1]};if(o){var ee=T&&P.name!==A;if(l((function(){P(1)}))&&l((function(){new P(-1)}))&&!l((function(){return new P,new P(1.5),new P(NaN),ee&&!S})))ee&&S&&c(P,"name",A);else{D=function(e){return f(this,U),new P(h(e))},D[x]=U;for(var te,ne=v(P),re=0;ne.length>re;)(te=ne[re++])in D||c(D,te,P[te]);U.constructor=D}g&&y(M)!==N&&g(M,N);var ie=new L(new D(2)),ae=i(M.setInt8);ie.setInt8(0,2147483648),ie.setInt8(1,2147483649),!ie.getInt8(0)&&ie.getInt8(1)||u(M,{setInt8:function(e,t){ae(this,e,t<<24>>24)},setUint8:function(e,t){ae(this,e,t<<24>>24)}},{unsafe:!0})}else D=function(e){f(this,U);var t=h(e);k(this,{bytes:j(B(t),0),byteLength:t}),a||(this.byteLength=t)},U=D[x],L=function(e,t,n){f(this,M),f(e,U);var r=I(e).byteLength,i=d(t);if(i<0||i>r)throw H("Wrong offset");if(n=void 0===n?r-i:p(n),i+n>r)throw H(O);k(this,{buffer:e,byteLength:n,byteOffset:i}),a||(this.buffer=e,this.byteLength=n,this.byteOffset=i)},M=L[x],a&&(X(D,"byteLength"),X(L,"buffer"),X(L,"byteLength"),X(L,"byteOffset")),u(M,{getInt8:function(e){return Q(this,1,e)[0]<<24>>24},getUint8:function(e){return Q(this,1,e)[0]},getInt16:function(e){var t=Q(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=Q(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return $(Q(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return $(Q(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return z(Q(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return z(Q(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){Z(this,1,e,W,t)},setUint8:function(e,t){Z(this,1,e,W,t)},setInt16:function(e,t){Z(this,2,e,q,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){Z(this,2,e,q,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){Z(this,4,e,Y,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){Z(this,4,e,Y,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){Z(this,4,e,K,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){Z(this,8,e,J,t,arguments.length>2?arguments[2]:void 0)}});E(D,A),E(L,R),e.exports={ArrayBuffer:D,DataView:L}},"649e":function(e,t,n){"use strict";var r=n("ebb5"),i=n("b727").some,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("some",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0)}))},"64d1":function(e,t,n){"use strict";n("c1c8")},7037:function(e,t,n){function r(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?(e.exports=r=function(e){return typeof e},e.exports["default"]=e.exports,e.exports.__esModule=!0):(e.exports=r=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports["default"]=e.exports,e.exports.__esModule=!0),r(t)}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),e.exports=r,e.exports["default"]=e.exports,e.exports.__esModule=!0},7039:function(e,t,n){var r=n("23e7"),i=n("d039"),a=n("057f").f,o=i((function(){return!Object.getOwnPropertyNames(1)}));r({target:"Object",stat:!0,forced:o},{getOwnPropertyNames:a})},7156:function(e,t,n){var r=n("1626"),i=n("861d"),a=n("d2bb");e.exports=function(e,t,n){var o,s;return a&&r(o=t.constructor)&&o!==n&&i(s=o.prototype)&&s!==n.prototype&&a(e,s),e}},"72f7":function(e,t,n){"use strict";var r=n("ebb5").exportTypedArrayMethod,i=n("d039"),a=n("da84"),o=n("e330"),s=a.Uint8Array,c=s&&s.prototype||{},u=[].toString,l=o([].join);i((function(){u.call({})}))&&(u=function(){return l(this)});var f=c.toString!=u;r("toString",u,f)},"735e":function(e,t,n){"use strict";var r=n("ebb5"),i=n("c65b"),a=n("81d5"),o=r.aTypedArray,s=r.exportTypedArrayMethod;s("fill",(function(e){var t=arguments.length;return i(a,o(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}))},"74e8":function(e,t,n){"use strict";var r=n("23e7"),i=n("da84"),a=n("c65b"),o=n("83ab"),s=n("8aa7"),c=n("ebb5"),u=n("621a"),l=n("19aa"),f=n("5c6c"),d=n("9112"),p=n("eac5"),h=n("50c4"),m=n("0b25"),y=n("182d"),g=n("a04b"),v=n("1a2d"),b=n("f5df"),_=n("861d"),w=n("d9b5"),E=n("7c73"),C=n("3a9b"),T=n("d2bb"),S=n("241c").f,I=n("a078"),k=n("b727").forEach,A=n("2626"),R=n("9bf2"),x=n("06cf"),O=n("69f3"),F=n("7156"),P=O.get,D=O.set,U=R.f,L=x.f,M=Math.round,N=i.RangeError,B=u.ArrayBuffer,H=B.prototype,j=u.DataView,V=c.NATIVE_ARRAY_BUFFER_VIEWS,G=c.TYPED_ARRAY_CONSTRUCTOR,z=c.TYPED_ARRAY_TAG,W=c.TypedArray,q=c.TypedArrayPrototype,Y=c.aTypedArrayConstructor,$=c.isTypedArray,K="BYTES_PER_ELEMENT",J="Wrong length",X=function(e,t){Y(e);var n=0,r=t.length,i=new e(r);while(r>n)i[n]=t[n++];return i},Q=function(e,t){U(e,t,{get:function(){return P(this)[t]}})},Z=function(e){var t;return C(H,e)||"ArrayBuffer"==(t=b(e))||"SharedArrayBuffer"==t},ee=function(e,t){return $(e)&&!w(t)&&t in e&&p(+t)&&t>=0},te=function(e,t){return t=g(t),ee(e,t)?f(2,e[t]):L(e,t)},ne=function(e,t,n){return t=g(t),!(ee(e,t)&&_(n)&&v(n,"value"))||v(n,"get")||v(n,"set")||n.configurable||v(n,"writable")&&!n.writable||v(n,"enumerable")&&!n.enumerable?U(e,t,n):(e[t]=n.value,e)};o?(V||(x.f=te,R.f=ne,Q(q,"buffer"),Q(q,"byteOffset"),Q(q,"byteLength"),Q(q,"length")),r({target:"Object",stat:!0,forced:!V},{getOwnPropertyDescriptor:te,defineProperty:ne}),e.exports=function(e,t,n){var o=e.match(/\d+$/)[0]/8,c=e+(n?"Clamped":"")+"Array",u="get"+e,f="set"+e,p=i[c],g=p,v=g&&g.prototype,b={},w=function(e,t){var n=P(e);return n.view[u](t*o+n.byteOffset,!0)},C=function(e,t,r){var i=P(e);n&&(r=(r=M(r))<0?0:r>255?255:255&r),i.view[f](t*o+i.byteOffset,r,!0)},R=function(e,t){U(e,t,{get:function(){return w(this,t)},set:function(e){return C(this,t,e)},enumerable:!0})};V?s&&(g=t((function(e,t,n,r){return l(e,v),F(function(){return _(t)?Z(t)?void 0!==r?new p(t,y(n,o),r):void 0!==n?new p(t,y(n,o)):new p(t):$(t)?X(g,t):a(I,g,t):new p(m(t))}(),e,g)})),T&&T(g,W),k(S(p),(function(e){e in g||d(g,e,p[e])})),g.prototype=v):(g=t((function(e,t,n,r){l(e,v);var i,s,c,u=0,f=0;if(_(t)){if(!Z(t))return $(t)?X(g,t):a(I,g,t);i=t,f=y(n,o);var d=t.byteLength;if(void 0===r){if(d%o)throw N(J);if(s=d-f,s<0)throw N(J)}else if(s=h(r)*o,s+f>d)throw N(J);c=s/o}else c=m(t),s=c*o,i=new B(s);D(e,{buffer:i,byteOffset:f,byteLength:s,length:c,view:new j(i)});while(u<c)R(e,u++)})),T&&T(g,W),v=g.prototype=E(q)),v.constructor!==g&&d(v,"constructor",g),d(v,G,g),z&&d(v,z,c),b[c]=g,r({global:!0,forced:g!=p,sham:!V},b),K in g||d(g,K,o),K in v||d(v,K,o),A(c)}):e.exports=function(){}},"77a7":function(e,t,n){var r=n("da84"),i=r.Array,a=Math.abs,o=Math.pow,s=Math.floor,c=Math.log,u=Math.LN2,l=function(e,t,n){var r,l,f,d=i(n),p=8*n-t-1,h=(1<<p)-1,m=h>>1,y=23===t?o(2,-24)-o(2,-77):0,g=e<0||0===e&&1/e<0?1:0,v=0;e=a(e),e!=e||e===1/0?(l=e!=e?1:0,r=h):(r=s(c(e)/u),f=o(2,-r),e*f<1&&(r--,f*=2),e+=r+m>=1?y/f:y*o(2,1-m),e*f>=2&&(r++,f/=2),r+m>=h?(l=0,r=h):r+m>=1?(l=(e*f-1)*o(2,t),r+=m):(l=e*o(2,m-1)*o(2,t),r=0));while(t>=8)d[v++]=255&l,l/=256,t-=8;r=r<<t|l,p+=t;while(p>0)d[v++]=255&r,r/=256,p-=8;return d[--v]|=128*g,d},f=function(e,t){var n,r=e.length,i=8*r-t-1,a=(1<<i)-1,s=a>>1,c=i-7,u=r-1,l=e[u--],f=127&l;l>>=7;while(c>0)f=256*f+e[u--],c-=8;n=f&(1<<-c)-1,f>>=-c,c+=t;while(c>0)n=256*n+e[u--],c-=8;if(0===f)f=1-s;else{if(f===a)return n?NaN:l?-1/0:1/0;n+=o(2,t),f-=s}return(l?-1:1)*n*o(2,f-t)};e.exports={pack:l,unpack:f}},"81d5":function(e,t,n){"use strict";var r=n("7b0b"),i=n("23cb"),a=n("07fa");e.exports=function(e){var t=r(this),n=a(t),o=arguments.length,s=i(o>1?arguments[1]:void 0,n),c=o>2?arguments[2]:void 0,u=void 0===c?n:i(c,n);while(u>s)t[s++]=e;return t}},"82f8":function(e,t,n){"use strict";var r=n("ebb5"),i=n("4d64").includes,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("includes",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0)}))},"8aa5":function(e,t,n){"use strict";var r=n("6547").charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},"8aa7":function(e,t,n){var r=n("da84"),i=n("d039"),a=n("1c7e"),o=n("ebb5").NATIVE_ARRAY_BUFFER_VIEWS,s=r.ArrayBuffer,c=r.Int8Array;e.exports=!o||!i((function(){c(1)}))||!i((function(){new c(-1)}))||!a((function(e){new c,new c(null),new c(1.5),new c(e)}),!0)||i((function(){return 1!==new c(new s(2),1,void 0).length}))},"907a":function(e,t,n){"use strict";var r=n("ebb5"),i=n("07fa"),a=n("5926"),o=r.aTypedArray,s=r.exportTypedArrayMethod;s("at",(function(e){var t=o(this),n=i(t),r=a(e),s=r>=0?r:n+r;return s<0||s>=n?void 0:t[s]}))},9129:function(e,t,n){var r=n("23e7");r({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},"93bf":function(e,t,n){
/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/
(function(){"use strict";var t="undefined"!==typeof window&&"undefined"!==typeof window.document?window.document:{},n=e.exports,r=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,i=n.length,a={};r<i;r++)if(e=n[r],e&&e[1]in t){for(r=0;r<e.length;r++)a[n[0][r]]=e[r];return a}return!1}(),i={change:r.fullscreenchange,error:r.fullscreenerror},a={request:function(e,n){return new Promise(function(i,a){var o=function(){this.off("change",o),i()}.bind(this);this.on("change",o),e=e||t.documentElement;var s=e[r.requestFullscreen](n);s instanceof Promise&&s.then(o).catch(a)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var i=function(){this.off("change",i),e()}.bind(this);this.on("change",i);var a=t[r.exitFullscreen]();a instanceof Promise&&a.then(i).catch(n)}else e()}.bind(this))},toggle:function(e,t){return this.isFullscreen?this.exit():this.request(e,t)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var r=i[e];r&&t.addEventListener(r,n,!1)},off:function(e,n){var r=i[e];r&&t.removeEventListener(r,n,!1)},raw:r};r?(Object.defineProperties(a,{isFullscreen:{get:function(){return Boolean(t[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[r.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[r.fullscreenEnabled])}}}),n?e.exports=a:window.screenfull=a):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}})()},"99af":function(e,t,n){"use strict";var r=n("23e7"),i=n("da84"),a=n("d039"),o=n("e8b5"),s=n("861d"),c=n("7b0b"),u=n("07fa"),l=n("8418"),f=n("65f0"),d=n("1dde"),p=n("b622"),h=n("2d00"),m=p("isConcatSpreadable"),y=9007199254740991,g="Maximum allowed index exceeded",v=i.TypeError,b=h>=51||!a((function(){var e=[];return e[m]=!1,e.concat()[0]!==e})),_=d("concat"),w=function(e){if(!s(e))return!1;var t=e[m];return void 0!==t?!!t:o(e)},E=!b||!_;r({target:"Array",proto:!0,forced:E},{concat:function(e){var t,n,r,i,a,o=c(this),s=f(o,0),d=0;for(t=-1,r=arguments.length;t<r;t++)if(a=-1===t?o:arguments[t],w(a)){if(i=u(a),d+i>y)throw v(g);for(n=0;n<i;n++,d++)n in a&&l(s,d,a[n])}else{if(d>=y)throw v(g);l(s,d++,a)}return s.length=d,s}})},"9a8c":function(e,t,n){"use strict";var r=n("e330"),i=n("ebb5"),a=n("145e"),o=r(a),s=i.aTypedArray,c=i.exportTypedArrayMethod;c("copyWithin",(function(e,t){return o(s(this),e,t,arguments.length>2?arguments[2]:void 0)}))},a078:function(e,t,n){var r=n("0366"),i=n("c65b"),a=n("5087"),o=n("7b0b"),s=n("07fa"),c=n("9a1f"),u=n("35a1"),l=n("e95a"),f=n("ebb5").aTypedArrayConstructor;e.exports=function(e){var t,n,d,p,h,m,y=a(this),g=o(e),v=arguments.length,b=v>1?arguments[1]:void 0,_=void 0!==b,w=u(g);if(w&&!l(w)){h=c(g,w),m=h.next,g=[];while(!(p=i(m,h)).done)g.push(p.value)}for(_&&v>2&&(b=r(b,arguments[2])),n=s(g),d=new(f(y))(n),t=0;n>t;t++)d[t]=_?b(g[t],t):g[t];return d}},a434:function(e,t,n){"use strict";var r=n("23e7"),i=n("da84"),a=n("23cb"),o=n("5926"),s=n("07fa"),c=n("7b0b"),u=n("65f0"),l=n("8418"),f=n("1dde"),d=f("splice"),p=i.TypeError,h=Math.max,m=Math.min,y=9007199254740991,g="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var n,r,i,f,d,v,b=c(this),_=s(b),w=a(e,_),E=arguments.length;if(0===E?n=r=0:1===E?(n=0,r=_-w):(n=E-2,r=m(h(o(t),0),_-w)),_+n-r>y)throw p(g);for(i=u(b,r),f=0;f<r;f++)d=w+f,d in b&&l(i,f,b[d]);if(i.length=r,n<r){for(f=w;f<_-r;f++)d=f+r,v=f+n,d in b?b[v]=b[d]:delete b[v];for(f=_;f>_-r+n;f--)delete b[f-1]}else if(n>r)for(f=_-r;f>w;f--)d=f+r-1,v=f+n-1,d in b?b[v]=b[d]:delete b[v];for(f=0;f<n;f++)b[f+w]=arguments[f+2];return b.length=_-r+n,i}})},a640:function(e,t,n){"use strict";var r=n("d039");e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){throw 1},1)}))}},a6fd:function(e,t,n){var r=n("23e7"),i=n("2ba4"),a=n("59ed"),o=n("825a"),s=n("d039"),c=!s((function(){Reflect.apply((function(){}))}));r({target:"Reflect",stat:!0,forced:c},{apply:function(e,t,n){return i(a(e),t,o(n))}})},a975:function(e,t,n){"use strict";var r=n("ebb5"),i=n("b727").every,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("every",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0)}))},a981:function(e,t){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},a9e3:function(e,t,n){"use strict";var r=n("83ab"),i=n("da84"),a=n("e330"),o=n("94ca"),s=n("6eeb"),c=n("1a2d"),u=n("7156"),l=n("3a9b"),f=n("d9b5"),d=n("c04e"),p=n("d039"),h=n("241c").f,m=n("06cf").f,y=n("9bf2").f,g=n("408a"),v=n("58a8").trim,b="Number",_=i[b],w=_.prototype,E=i.TypeError,C=a("".slice),T=a("".charCodeAt),S=function(e){var t=d(e,"number");return"bigint"==typeof t?t:I(t)},I=function(e){var t,n,r,i,a,o,s,c,u=d(e,"number");if(f(u))throw E("Cannot convert a Symbol value to a number");if("string"==typeof u&&u.length>2)if(u=v(u),t=T(u,0),43===t||45===t){if(n=T(u,2),88===n||120===n)return NaN}else if(48===t){switch(T(u,1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+u}for(a=C(u,2),o=a.length,s=0;s<o;s++)if(c=T(a,s),c<48||c>i)return NaN;return parseInt(a,r)}return+u};if(o(b,!_(" 0o1")||!_("0b1")||_("+0x1"))){for(var k,A=function(e){var t=arguments.length<1?0:_(S(e)),n=this;return l(w,n)&&p((function(){g(n)}))?u(Object(t),n,A):t},R=r?h(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),x=0;R.length>x;x++)c(_,k=R[x])&&!c(A,k)&&y(A,k,m(_,k));A.prototype=w,w.constructor=A,s(i,b,A)}},b39a:function(e,t,n){"use strict";var r=n("da84"),i=n("2ba4"),a=n("ebb5"),o=n("d039"),s=n("f36a"),c=r.Int8Array,u=a.aTypedArray,l=a.exportTypedArrayMethod,f=[].toLocaleString,d=!!c&&o((function(){f.call(new c(1))})),p=o((function(){return[1,2].toLocaleString()!=new c([1,2]).toLocaleString()}))||!o((function(){c.prototype.toLocaleString.call([1,2])}));l("toLocaleString",(function(){return i(f,d?s(u(this)):u(this),s(arguments))}),p)},b64b:function(e,t,n){var r=n("23e7"),i=n("7b0b"),a=n("df75"),o=n("d039"),s=o((function(){a(1)}));r({target:"Object",stat:!0,forced:s},{keys:function(e){return a(i(e))}})},b6b7:function(e,t,n){var r=n("ebb5"),i=n("4840"),a=r.TYPED_ARRAY_CONSTRUCTOR,o=r.aTypedArrayConstructor;e.exports=function(e){return o(i(e,e[a]))}},c19f:function(e,t,n){"use strict";var r=n("23e7"),i=n("da84"),a=n("621a"),o=n("2626"),s="ArrayBuffer",c=a[s],u=i[s];r({global:!0,forced:u!==c},{ArrayBuffer:c}),o(s)},c1ac:function(e,t,n){"use strict";var r=n("ebb5"),i=n("b727").filter,a=n("1448"),o=r.aTypedArray,s=r.exportTypedArrayMethod;s("filter",(function(e){var t=i(o(this),e,arguments.length>1?arguments[1]:void 0);return a(this,t)}))},c1c8:function(e,t,n){},ca91:function(e,t,n){"use strict";var r=n("ebb5"),i=n("d58f").left,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("reduce",(function(e){var t=arguments.length;return i(a(this),e,t,t>1?arguments[1]:void 0)}))},cd26:function(e,t,n){"use strict";var r=n("ebb5"),i=r.aTypedArray,a=r.exportTypedArrayMethod,o=Math.floor;a("reverse",(function(){var e,t=this,n=i(t).length,r=o(n/2),a=0;while(a<r)e=t[a],t[a++]=t[--n],t[n]=e;return t}))},cfc3:function(e,t,n){var r=n("74e8");r("Float32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},d022:function(e,t,n){var r,i,a,o,s=n("7037").default;n("d3b7"),n("f8c9"),n("a6fd"),n("1bf2"),n("a4d3"),n("99af"),n("7039"),n("9129"),n("a9e3"),n("3410"),n("b0c0"),n("b64b"),n("fb6a"),n("e01a"),n("d28b"),n("3ca3"),n("ddb0"),n("4ae1"),n("2b3d"),n("9861"),n("25f0"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("cfc3"),n("4a9b"),n("159b"),n("ac1f"),n("5319"),n("e9c4"),n("5377"),n("466d"),n("4e82"),n("a434"),n("c19f"),function(n){"object"===s(t)&&"undefined"!==typeof e?e.exports=n():(i=[],r=n,a="function"===typeof r?r.apply(t,i):r,void 0===a||(e.exports=a))}((function(){var e;return function(){function e(t,n,r){function i(s,c){if(!n[s]){if(!t[s]){var u="function"==typeof o&&o;if(!c&&u)return o(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var f=n[s]={exports:{}};t[s][0].call(f.exports,(function(e){var n=t[s][1][e];return i(n||e)}),f,f.exports,e,t,n,r)}return n[s].exports}for(var a="function"==typeof o&&o,s=0;s<r.length;s++)i(r[s]);return i}return e}()({1:[function(e,t,n){"use strict";var r,i="object"===("undefined"===typeof Reflect?"undefined":s(Reflect))?Reflect:null,a=i&&"function"===typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};function o(e){console&&console.warn&&console.warn(e)}r=i&&"function"===typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var c=Number.isNaN||function(e){return e!==e};function u(){u.init.call(this)}t.exports=u,t.exports.once=w,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var l=10;function f(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+s(e))}function d(e){return void 0===e._maxListeners?u.defaultMaxListeners:e._maxListeners}function p(e,t,n,r){var i,a,s;if(f(n),a=e._events,void 0===a?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),s=a[t]),void 0===s)s=a[t]=n,++e._eventsCount;else if("function"===typeof s?s=a[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),i=d(e),i>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,o(c)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=h.bind(r);return i.listener=n,r.wrapFn=i,i}function y(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"===typeof i?n?[i.listener||i]:[i]:n?_(i):v(i,i.length)}function g(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function v(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function b(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function _(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function w(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,a),r(n)}function a(){"function"===typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}C(e,t,a,{once:!0}),"error"!==t&&E(e,i,{once:!0})}))}function E(e,t,n){"function"===typeof e.on&&C(e,"error",t,n)}function C(e,t,n,r){if("function"===typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+s(e));e.addEventListener(t,(function i(a){r.once&&e.removeEventListener(t,i),n(a)}))}}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!==typeof e||e<0||c(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),u.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||c(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},u.prototype.getMaxListeners=function(){return d(this)},u.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var c=i[e];if(void 0===c)return!1;if("function"===typeof c)a(c,this,t);else{var u=c.length,l=v(c,u);for(n=0;n<u;++n)a(l[n],this,t)}return!0},u.prototype.addListener=function(e,t){return p(this,e,t,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(e,t){return p(this,e,t,!0)},u.prototype.once=function(e,t){return f(t),this.on(e,m(this,e,t)),this},u.prototype.prependOnceListener=function(e,t){return f(t),this.prependListener(e,m(this,e,t)),this},u.prototype.removeListener=function(e,t){var n,r,i,a,o;if(f(t),r=this._events,void 0===r)return this;if(n=r[e],void 0===n)return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():b(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(e){var t,n,r;if(n=this._events,void 0===n)return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,a=Object.keys(n);for(r=0;r<a.length;++r)i=a[r],"removeListener"!==i&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],"function"===typeof t)this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},u.prototype.listeners=function(e){return y(this,e,!0)},u.prototype.rawListeners=function(e){return y(this,e,!1)},u.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},u.prototype.listenerCount=g,u.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},{}],2:[function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=e("../errors"),a=c(e("../events")),o=c(e("../event-handler")),s=c(e("./fix-webm-duration"));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function h(e){var t=g();return function(){var n,r=v(e);if(t){var i=v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var b=function(e){d(n,e);var t=h(n);function n(e){var r;return u(this,n),r=t.call(this,e,a.default.MEDIA_ATTACHING,a.default.BUFFER_APPENDING,a.default.BUFFER_RESET,a.default.RECORDING_START,a.default.RECORDING_STOP),r.rec_threshold_total=17179869184,r.rec_threshold_single=1073741824,r.rec_mimeType="video/webm",r.rec_blobType="video/webm",r.rec_file_ext=".webm",r.rec_timer=void 0,r.rec_start_tm=0,r.rec_file="",r.rec_result_cb=void 0,r.rec_state_cb=void 0,r.mediaSource=null,r.mediaRecorder=null,r.mediaParts=[],r.mediaSize=0,r.media=null,r.pendingTracks={},r.sourceBuffer={},r.segments=[],r.appended=0,r._msDuration=null,r.mediaErrorCount=0,r.count=0,r.onsbue=r.onSBUpdateEnd.bind(y(r)),r.browserType=0,-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&(r.browserType=1),r.mediaType="",r.websocketName=void 0,r.channelName=void 0,r._fs=null,r}return f(n,[{key:"destroy",value:function(){o.default.prototype.destroy.call(this)}},{key:"pad2",value:function(e){return e<10?"0"+e:e}},{key:"onRecordingProc",value:function(){var e=this;if(null==e._fs)return e.rec_result_cb&&e.rec_result_cb(!1),void console.log("fs is not authorized");e.rec_timer&&(clearInterval(e.rec_timer),e.rec_timer=void 0),e.count=0,e.rec_timer=setInterval((function(){if(""==e.mediaType||"H264Raw"==e.mediaType&&e.appended>10){clearInterval(e.rec_timer),e.rec_timer=void 0;var t=new Date,n=1900+t.getYear()+"-"+e.pad2(t.getMonth()+1)+"-"+e.pad2(t.getDate())+"_"+e.pad2(t.getHours())+"-"+e.pad2(t.getMinutes())+"-"+e.pad2(t.getSeconds());e.rec_file="ax_"+n+e.rec_file_ext,e.mediaParts=[],e.mediaSize=0,e.mediaRecorder=new MediaRecorder(e.wfs.media.captureStream(),{mimeType:e.rec_mimeType}),e.mediaRecorder.start(500),e.rec_start_tm=Date.now(),e.mediaRecorder.ondataavailable=function(t){var n=t.data;n&&n.size>0&&(e.mediaParts.push(n),e.mediaSize+=n.size,e.mediaSize>=e.rec_threshold_single&&(e.rec_state_cb&&e.rec_state_cb(!1),e.onRecordingStop(),e.onRecordingStart(),e.rec_state_cb&&e.rec_state_cb(!0)))},e.mediaRecorder.onstop=function(){var t=e.rec_file,n=Date.now()-e.rec_start_tm,r=new Blob(e.mediaParts,{type:e.rec_blobType});(0,s.default)(r,n,(function(n){var r=Date.now();console.log("Start to save blob to webm file..."),e.writeData(t,n),console.log("Save webm file finished, elapsed: "+(Date.now()-r))}))},console.log("MediaRecorder started: "+e.rec_file),e.rec_result_cb&&e.rec_result_cb(!0)}else e.count++;e.count>=10&&(clearInterval(e.rec_timer),e.rec_timer=void 0,e.rec_result_cb&&e.rec_result_cb(!1))}),1e3)}},{key:"onRecordingStart",value:function(e){if(this.mediaRecorder&&"inactive"!=this.mediaRecorder.state)console.log("recording is in progress");else{void 0!=e&&(this.rec_threshold_single=e.rec_file_threshold,this.rec_result_cb=e.result_cb,this.rec_state_cb=e.state_cb);var t=this;navigator.webkitPersistentStorage.queryUsageAndQuota((function(e,n){""==n?(console.log("File system(sandbox) not requested."),t.requestFs()):(console.log("Used space: "+e+" bytes"),console.log("Total space: "+n+" bytes"),window.webkitRequestFileSystem(window.PERSISTENT,t.rec_threshold_total,(function(e){t._fs=e,e.root.getDirectory("ax_video",{create:!0},(function(e){console.log("Directory: "+e.name+" fs requested"),t.onRecordingProc()}),t.errorHandler)})))}),this.errorHandler)}}},{key:"onRecordingStop",value:function(){this.mediaRecorder&&"inactive"!=this.mediaRecorder.state&&(this.rec_timer&&(clearInterval(this.rec_timer),this.rec_timer=void 0),this.mediaRecorder.stop(),console.log("MediaRecorder stopped"))}},{key:"errorHandler",value:function(e){var t="An error occured(errcd): ";console.log(t+e.code)}},{key:"requestFs",value:function(){var e=this;navigator.webkitPersistentStorage.requestQuota(this.rec_threshold_total,(function(t){console.log("grantedBytes: "+t),t>0?window.webkitRequestFileSystem(window.PERSISTENT,t,(function(t){e._fs=t,t.root.getDirectory("ax_video",{create:!0},(function(t){console.log("Directory: "+t.name+" exists or just created."),e.onRecordingProc()}),e.errorHandler)})):e.rec_result_cb&&e.rec_result_cb(!1)}))}},{key:"onMediaAttaching",value:function(e){var t=this.media=e.media;if(this.mediaType=e.mediaType,this.websocketName=e.websocketName,this.channelName=e.channelName,t){var n=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),n.addEventListener("sourceopen",this.onmso),n.addEventListener("sourceended",this.onmse),n.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(n)}}},{key:"onMediaDetaching",value:function(){}},{key:"writeData",value:function(e,t){var n=this;this._fs.root.getFile("ax_video/"+e,{create:!0},(function(e){e.createWriter((function(e){e.onwriteend=function(e){},e.onerror=function(e){console.log("Write rec data failed: "+e.toString())},e.seek(e.length),e.write(t)}),n.errorHandler)}),this.errorHandler)}},{key:"onBufferAppending",value:function(e){this.segments?this.segments.push(e):this.segments=[e],this.doAppending()}},{key:"onMediaSourceClose",value:function(){console.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){console.log("media source ended")}},{key:"onSBUpdateEnd",value:function(e){1===this.browserType&&(this.mediaSource.endOfStream(),this.media.play()),this.appending=!1,this.doAppending(),this.updateMediaElementDuration()}},{key:"updateMediaElementDuration",value:function(){}},{key:"onMediaSourceOpen",value:function(){console.log("media source open");var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),"FMp4"===this.mediaType&&this.checkPendingTracks(),this.wfs.trigger(a.default.MEDIA_ATTACHED,{media:this.media,channelName:this.channelName,mediaType:this.mediaType,websocketName:this.websocketName})}},{key:"checkPendingTracks",value:function(){this.createSourceBuffers({tracks:"video",mimeType:""}),this.pendingTracks={}}},{key:"onBufferReset",value:function(e){"H264Raw"===this.mediaType&&this.createSourceBuffers({tracks:"video",mimeType:e.mimeType})}},{key:"createSourceBuffers",value:function(t){var n,r=this.sourceBuffer,i=this.mediaSource;n=""===t.mimeType?"video/mp4;codecs=avc1.420028":"video/mp4;codecs="+t.mimeType;try{var o=r["video"]=i.addSourceBuffer(n);o.addEventListener("updateend",this.onsbue),t.buffer=o}catch(e){}this.wfs.trigger(a.default.BUFFER_CREATED,{tracks:t}),this.media.play()}},{key:"doAppending",value:function e(){var t=this.wfs,n=this.sourceBuffer,r=this.segments;if(Object.keys(n).length){if(this.media.error){if(this.segments=[],this.mediaErrorCount++,this.mediaErrorCount<100)console.log("trying to append although a media error occured, flush segment and abort");else{var o={type:i.ErrorTypes.MEDIA_ERROR};o.details=i.ErrorDetails.BUFFER_APPEND_ERROR,o.frag=this.fragCurrent,o.fatal=!0,this.wfs.trigger(a.default.ERROR,o)}return}if(this.mediaErrorCount=0,this.appending)return;if(r&&r.length){var s=r.shift();try{n[s.type]&&(this.parent=s.parent,n[s.type].appendBuffer(s.data),this.appendError=0,this.appended++,this.appending=!0)}catch(e){r.unshift(s);var c={type:i.ErrorTypes.MEDIA_ERROR};22!==e.code?(this.appendError?this.appendError++:this.appendError=1,c.details=i.ErrorDetails.BUFFER_APPEND_ERROR,c.frag=this.fragCurrent,this.appendError>t.config.appendErrorMaxRetry?(r=[],c.fatal=!0):c.fatal=!1):(this.segments=[],c.details=i.ErrorDetails.BUFFER_FULL_ERROR,c.fatal=!0),this.wfs.trigger(a.default.ERROR,c)}}}}}]),n}(o.default),_=b;n.default=_},{"../errors":7,"../event-handler":8,"../events":9,"./fix-webm-duration":3}],3:[function(t,n,r){"use strict";(function(t,r){"function"===typeof e&&e.amd?e(r):"undefined"!==typeof n&&n.exports?n.exports=r():window.ysFixWebmDuration=r()})(0,(function(){var e={172351395:{name:"EBML",type:"Container"},646:{name:"EBMLVersion",type:"Uint"},759:{name:"EBMLReadVersion",type:"Uint"},754:{name:"EBMLMaxIDLength",type:"Uint"},755:{name:"EBMLMaxSizeLength",type:"Uint"},642:{name:"DocType",type:"String"},647:{name:"DocTypeVersion",type:"Uint"},645:{name:"DocTypeReadVersion",type:"Uint"},108:{name:"Void",type:"Binary"},63:{name:"CRC-32",type:"Binary"},190023271:{name:"SignatureSlot",type:"Container"},16010:{name:"SignatureAlgo",type:"Uint"},16026:{name:"SignatureHash",type:"Uint"},16037:{name:"SignaturePublicKey",type:"Binary"},16053:{name:"Signature",type:"Binary"},15963:{name:"SignatureElements",type:"Container"},15995:{name:"SignatureElementList",type:"Container"},9522:{name:"SignedElement",type:"Binary"},139690087:{name:"Segment",type:"Container"},21863284:{name:"SeekHead",type:"Container"},3515:{name:"Seek",type:"Container"},5035:{name:"SeekID",type:"Binary"},5036:{name:"SeekPosition",type:"Uint"},88713574:{name:"Info",type:"Container"},13220:{name:"SegmentUID",type:"Binary"},13188:{name:"SegmentFilename",type:"String"},1882403:{name:"PrevUID",type:"Binary"},1868715:{name:"PrevFilename",type:"String"},2013475:{name:"NextUID",type:"Binary"},1999803:{name:"NextFilename",type:"String"},1092:{name:"SegmentFamily",type:"Binary"},10532:{name:"ChapterTranslate",type:"Container"},10748:{name:"ChapterTranslateEditionUID",type:"Uint"},10687:{name:"ChapterTranslateCodec",type:"Uint"},10661:{name:"ChapterTranslateID",type:"Binary"},710577:{name:"TimecodeScale",type:"Uint"},1161:{name:"Duration",type:"Float"},1121:{name:"DateUTC",type:"Date"},15273:{name:"Title",type:"String"},3456:{name:"MuxingApp",type:"String"},5953:{name:"WritingApp",type:"String"},103:{name:"Timecode",type:"Uint"},6228:{name:"SilentTracks",type:"Container"},6359:{name:"SilentTrackNumber",type:"Uint"},39:{name:"Position",type:"Uint"},43:{name:"PrevSize",type:"Uint"},35:{name:"SimpleBlock",type:"Binary"},32:{name:"BlockGroup",type:"Container"},33:{name:"Block",type:"Binary"},34:{name:"BlockVirtual",type:"Binary"},13729:{name:"BlockAdditions",type:"Container"},38:{name:"BlockMore",type:"Container"},110:{name:"BlockAddID",type:"Uint"},37:{name:"BlockAdditional",type:"Binary"},27:{name:"BlockDuration",type:"Uint"},122:{name:"ReferencePriority",type:"Uint"},123:{name:"ReferenceBlock",type:"Int"},125:{name:"ReferenceVirtual",type:"Int"},36:{name:"CodecState",type:"Binary"},13730:{name:"DiscardPadding",type:"Int"},14:{name:"Slices",type:"Container"},104:{name:"TimeSlice",type:"Container"},76:{name:"LaceNumber",type:"Uint"},77:{name:"FrameNumber",type:"Uint"},75:{name:"BlockAdditionID",type:"Uint"},78:{name:"Delay",type:"Uint"},79:{name:"SliceDuration",type:"Uint"},72:{name:"ReferenceFrame",type:"Container"},73:{name:"ReferenceOffset",type:"Uint"},74:{name:"ReferenceTimeCode",type:"Uint"},47:{name:"EncryptedBlock",type:"Binary"},106212971:{name:"Tracks",type:"Container"},46:{name:"TrackEntry",type:"Container"},87:{name:"TrackNumber",type:"Uint"},13253:{name:"TrackUID",type:"Uint"},3:{name:"TrackType",type:"Uint"},57:{name:"FlagEnabled",type:"Uint"},8:{name:"FlagDefault",type:"Uint"},5546:{name:"FlagForced",type:"Uint"},28:{name:"FlagLacing",type:"Uint"},11751:{name:"MinCache",type:"Uint"},11768:{name:"MaxCache",type:"Uint"},254851:{name:"DefaultDuration",type:"Uint"},216698:{name:"DefaultDecodedFieldDuration",type:"Uint"},209231:{name:"TrackTimecodeScale",type:"Float"},4991:{name:"TrackOffset",type:"Int"},5614:{name:"MaxBlockAdditionID",type:"Uint"},4974:{name:"Name",type:"String"},177564:{name:"Language",type:"String"},6:{name:"CodecID",type:"String"},9122:{name:"CodecPrivate",type:"Binary"},362120:{name:"CodecName",type:"String"},13382:{name:"AttachmentLink",type:"Uint"},1742487:{name:"CodecSettings",type:"String"},1785920:{name:"CodecInfoURL",type:"String"},438848:{name:"CodecDownloadURL",type:"String"},42:{name:"CodecDecodeAll",type:"Uint"},12203:{name:"TrackOverlay",type:"Uint"},5802:{name:"CodecDelay",type:"Uint"},5819:{name:"SeekPreRoll",type:"Uint"},9764:{name:"TrackTranslate",type:"Container"},9980:{name:"TrackTranslateEditionUID",type:"Uint"},9919:{name:"TrackTranslateCodec",type:"Uint"},9893:{name:"TrackTranslateTrackID",type:"Binary"},96:{name:"Video",type:"Container"},26:{name:"FlagInterlaced",type:"Uint"},5048:{name:"StereoMode",type:"Uint"},5056:{name:"AlphaMode",type:"Uint"},5049:{name:"OldStereoMode",type:"Uint"},48:{name:"PixelWidth",type:"Uint"},58:{name:"PixelHeight",type:"Uint"},5290:{name:"PixelCropBottom",type:"Uint"},5307:{name:"PixelCropTop",type:"Uint"},5324:{name:"PixelCropLeft",type:"Uint"},5341:{name:"PixelCropRight",type:"Uint"},5296:{name:"DisplayWidth",type:"Uint"},5306:{name:"DisplayHeight",type:"Uint"},5298:{name:"DisplayUnit",type:"Uint"},5299:{name:"AspectRatioType",type:"Uint"},963876:{name:"ColourSpace",type:"Binary"},1029411:{name:"GammaValue",type:"Float"},230371:{name:"FrameRate",type:"Float"},97:{name:"Audio",type:"Container"},53:{name:"SamplingFrequency",type:"Float"},14517:{name:"OutputSamplingFrequency",type:"Float"},31:{name:"Channels",type:"Uint"},15739:{name:"ChannelPositions",type:"Binary"},8804:{name:"BitDepth",type:"Uint"},98:{name:"TrackOperation",type:"Container"},99:{name:"TrackCombinePlanes",type:"Container"},100:{name:"TrackPlane",type:"Container"},101:{name:"TrackPlaneUID",type:"Uint"},102:{name:"TrackPlaneType",type:"Uint"},105:{name:"TrackJoinBlocks",type:"Container"},109:{name:"TrackJoinUID",type:"Uint"},64:{name:"TrickTrackUID",type:"Uint"},65:{name:"TrickTrackSegmentUID",type:"Binary"},70:{name:"TrickTrackFlag",type:"Uint"},71:{name:"TrickMasterTrackUID",type:"Uint"},68:{name:"TrickMasterTrackSegmentUID",type:"Binary"},11648:{name:"ContentEncodings",type:"Container"},8768:{name:"ContentEncoding",type:"Container"},4145:{name:"ContentEncodingOrder",type:"Uint"},4146:{name:"ContentEncodingScope",type:"Uint"},4147:{name:"ContentEncodingType",type:"Uint"},4148:{name:"ContentCompression",type:"Container"},596:{name:"ContentCompAlgo",type:"Uint"},597:{name:"ContentCompSettings",type:"Binary"},4149:{name:"ContentEncryption",type:"Container"},2017:{name:"ContentEncAlgo",type:"Uint"},2018:{name:"ContentEncKeyID",type:"Binary"},2019:{name:"ContentSignature",type:"Binary"},2020:{name:"ContentSigKeyID",type:"Binary"},2021:{name:"ContentSigAlgo",type:"Uint"},2022:{name:"ContentSigHashAlgo",type:"Uint"},206814059:{name:"Cues",type:"Container"},59:{name:"CuePoint",type:"Container"},51:{name:"CueTime",type:"Uint"},55:{name:"CueTrackPositions",type:"Container"},119:{name:"CueTrack",type:"Uint"},113:{name:"CueClusterPosition",type:"Uint"},112:{name:"CueRelativePosition",type:"Uint"},50:{name:"CueDuration",type:"Uint"},4984:{name:"CueBlockNumber",type:"Uint"},106:{name:"CueCodecState",type:"Uint"},91:{name:"CueReference",type:"Container"},22:{name:"CueRefTime",type:"Uint"},23:{name:"CueRefCluster",type:"Uint"},4959:{name:"CueRefNumber",type:"Uint"},107:{name:"CueRefCodecState",type:"Uint"},155296873:{name:"Attachments",type:"Container"},8615:{name:"AttachedFile",type:"Container"},1662:{name:"FileDescription",type:"String"},1646:{name:"FileName",type:"String"},1632:{name:"FileMimeType",type:"String"},1628:{name:"FileData",type:"Binary"},1710:{name:"FileUID",type:"Uint"},1653:{name:"FileReferral",type:"Binary"},1633:{name:"FileUsedStartTime",type:"Uint"},1634:{name:"FileUsedEndTime",type:"Uint"},4433776:{name:"Chapters",type:"Container"},1465:{name:"EditionEntry",type:"Container"},1468:{name:"EditionUID",type:"Uint"},1469:{name:"EditionFlagHidden",type:"Uint"},1499:{name:"EditionFlagDefault",type:"Uint"},1501:{name:"EditionFlagOrdered",type:"Uint"},54:{name:"ChapterAtom",type:"Container"},13252:{name:"ChapterUID",type:"Uint"},5716:{name:"ChapterStringUID",type:"String"},17:{name:"ChapterTimeStart",type:"Uint"},18:{name:"ChapterTimeEnd",type:"Uint"},24:{name:"ChapterFlagHidden",type:"Uint"},1432:{name:"ChapterFlagEnabled",type:"Uint"},11879:{name:"ChapterSegmentUID",type:"Binary"},11964:{name:"ChapterSegmentEditionUID",type:"Uint"},9155:{name:"ChapterPhysicalEquiv",type:"Uint"},15:{name:"ChapterTrack",type:"Container"},9:{name:"ChapterTrackNumber",type:"Uint"},0:{name:"ChapterDisplay",type:"Container"},5:{name:"ChapString",type:"String"},892:{name:"ChapLanguage",type:"String"},894:{name:"ChapCountry",type:"String"},10564:{name:"ChapProcess",type:"Container"},10581:{name:"ChapProcessCodecID",type:"Uint"},1293:{name:"ChapProcessPrivate",type:"Binary"},10513:{name:"ChapProcessCommand",type:"Container"},10530:{name:"ChapProcessTime",type:"Uint"},10547:{name:"ChapProcessData",type:"Binary"},39109479:{name:"Tags",type:"Container"},13171:{name:"Tag",type:"Container"},9152:{name:"Targets",type:"Container"},10442:{name:"TargetTypeValue",type:"Uint"},9162:{name:"TargetType",type:"String"},9157:{name:"TagTrackUID",type:"Uint"},9161:{name:"TagEditionUID",type:"Uint"},9156:{name:"TagChapterUID",type:"Uint"},9158:{name:"TagAttachmentUID",type:"Uint"},10184:{name:"SimpleTag",type:"Container"},1443:{name:"TagName",type:"String"},1146:{name:"TagLanguage",type:"String"},1156:{name:"TagDefault",type:"Uint"},1159:{name:"TagString",type:"String"},1157:{name:"TagBinary",type:"Binary"}};function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e}function n(e,t){this.name=e||"Unknown",this.type=t||"Unknown"}function r(e,t){n.call(this,e,t||"Uint")}function i(e){return e.length%2===1?"0"+e:e}function a(e,t){n.call(this,e,t||"Float")}function o(e,t){n.call(this,e,t||"Container")}function s(e){o.call(this,"File","File"),this.setSource(e)}return n.prototype.updateBySource=function(){},n.prototype.setSource=function(e){this.source=e,this.updateBySource()},n.prototype.updateByData=function(){},n.prototype.setData=function(e){this.data=e,this.updateByData()},t(r,n),r.prototype.updateBySource=function(){this.data="";for(var e=0;e<this.source.length;e++){var t=this.source[e].toString(16);this.data+=i(t)}},r.prototype.updateByData=function(){var e=this.data.length/2;this.source=new Uint8Array(e);for(var t=0;t<e;t++){var n=this.data.substr(2*t,2);this.source[t]=parseInt(n,16)}},r.prototype.getValue=function(){return parseInt(this.data,16)},r.prototype.setValue=function(e){this.setData(i(e.toString(16)))},t(a,n),a.prototype.getFloatArrayType=function(){return this.source&&4===this.source.length?Float32Array:Float64Array},a.prototype.updateBySource=function(){var e=this.source.reverse(),t=this.getFloatArrayType(),n=new t(e.buffer);this.data=n[0]},a.prototype.updateByData=function(){var e=this.getFloatArrayType(),t=new e([this.data]),n=new Uint8Array(t.buffer);this.source=n.reverse()},a.prototype.getValue=function(){return this.data},a.prototype.setValue=function(e){this.setData(e)},t(o,n),o.prototype.readByte=function(){return this.source[this.offset++]},o.prototype.readUint=function(){for(var e=this.readByte(),t=8-e.toString(2).length,n=e-(1<<7-t),r=0;r<t;r++)n*=256,n+=this.readByte();return n},o.prototype.updateBySource=function(){for(this.data=[],this.offset=0;this.offset<this.source.length;this.offset=s){var t=this.readUint(),i=this.readUint(),s=Math.min(this.offset+i,this.source.length),c=this.source.slice(this.offset,s),u=e[t]||{name:"Unknown",type:"Unknown"},l=n;switch(u.type){case"Container":l=o;break;case"Uint":l=r;break;case"Float":l=a;break}var f=new l(u.name,u.type);f.setSource(c),this.data.push({id:t,idHex:t.toString(16),data:f})}},o.prototype.writeUint=function(e,t){for(var n=1,r=128;e>=r&&n<8;n++,r*=128);if(!t)for(var i=r+e,a=n-1;a>=0;a--){var o=i%256;this.source[this.offset+a]=o,i=(i-o)/256}this.offset+=n},o.prototype.writeSections=function(e){this.offset=0;for(var t=0;t<this.data.length;t++){var n=this.data[t],r=n.data.source,i=r.length;this.writeUint(n.id,e),this.writeUint(i,e),e||this.source.set(r,this.offset),this.offset+=i}return this.offset},o.prototype.updateByData=function(){var e=this.writeSections("draft");this.source=new Uint8Array(e),this.writeSections()},o.prototype.getSectionById=function(e){for(var t=0;t<this.data.length;t++){var n=this.data[t];if(n.id===e)return n.data}return null},t(s,o),s.prototype.fixDuration=function(e){var t=this.getSectionById(139690087);if(!t)return console.log("[fix-webm-duration] Segment section is missing"),!1;var n=t.getSectionById(88713574);if(!n)return console.log("[fix-webm-duration] Info section is missing"),!1;var r=n.getSectionById(710577);if(!r)return console.log("[fix-webm-duration] TimecodeScale section is missing"),!1;var i=n.getSectionById(1161);if(i){if(!(i.getValue()<=0))return console.log("[fix-webm-duration] Duration section is present"),!1;console.log("[fix-webm-duration] Duration section is present, but the value is empty"),i.setValue(e)}else console.log("[fix-webm-duration] Duration section is missing"),i=new a("Duration","Float"),i.setValue(e),n.data.push({id:1161,data:i});return r.setValue(1e6),n.updateByData(),t.updateByData(),this.updateByData(),!0},s.prototype.toBlob=function(){return new Blob([this.source.buffer],{type:"video/webm"})},function(e,n,r){try{var i=new FileReader;i.onloadend=function(){try{var t=new s(new Uint8Array(i.result));t.fixDuration(n)&&(e=t.toBlob())}catch(t){}r(e)},i.readAsArrayBuffer(e)}catch(t){r(e)}}}))},{}],4:[function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(e("../events")),a=o(e("../event-handler"));function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function d(e){var t=m();return function(){var n,r=y(e);if(t){var i=y(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}function p(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var g=function(e){l(n,e);var t=d(n);function n(e){var r;return s(this,n),r=t.call(this,e,i.default.MEDIA_ATTACHED,i.default.BUFFER_CREATED,i.default.FILE_PARSING_DATA,i.default.FILE_HEAD_LOADED,i.default.FILE_DATA_LOADED,i.default.WEBSOCKET_ATTACHED,i.default.FRAG_PARSING_DATA,i.default.FRAG_PARSING_INIT_SEGMENT),r.fileStart=0,r.fileEnd=0,r.pendingAppending=0,r.mediaType=void 0,r.channelName,r}return u(n,[{key:"destroy",value:function(){a.default.prototype.destroy.call(this)}},{key:"onMediaAttached",value:function(e){if(console.log("media attached"),void 0!=e.websocketName){var t="ws://"+window.location.host+"/"+e.websocketName,n="binary",r=new WebSocket(t,n);this.wfs.attachWebsocket(r,e.websocketName,e.channelName)}else console.log("websocketName ERROE!!!")}},{key:"onBufferCreated",value:function(e){this.mediaType=e.mediaType}},{key:"onFileHeadLoaded",value:function(e){}},{key:"onFileDataLoaded",value:function(e){}},{key:"onFileParsingData",value:function(e){}},{key:"onWebsocketAttached",value:function(e){this.wfs.trigger(i.default.BUFFER_APPENDING,{type:"video",data:e.payload,parent:"main"})}},{key:"onFragParsingInitSegment",value:function(e){var t,n,r=e.tracks;for(t in n=r.video,n&&(n.id=e.id),r){n=r[t];var a=n.initSegment;a&&(this.pendingAppending++,this.wfs.trigger(i.default.BUFFER_APPENDING,{type:t,data:a,parent:"main"}))}}},{key:"onFragParsingData",value:function(e){var t=this;e.type,[e.data1,e.data2].forEach((function(n){n&&(t.pendingAppending++,t.wfs.trigger(i.default.BUFFER_APPENDING,{type:e.type,data:n,parent:"main"}))}))}}]),n}(a.default),v=g;n.default=v},{"../event-handler":8,"../events":9}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("../utils/logger");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var s=function(){function e(t){i(this,e),this.data=t,this.bytesAvailable=this.data.byteLength,this.word=0,this.bitsAvailable=0}return o(e,[{key:"loadWord",value:function(){var e=this.data.byteLength-this.bytesAvailable,t=new Uint8Array(4),n=Math.min(4,this.bytesAvailable);if(0===n)throw new Error("no bytes available");t.set(this.data.subarray(e,e+n)),this.word=new DataView(t.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n}},{key:"skipBits",value:function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;return e>32&&r.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),t=e-t,t>0?n<<t|this.readBits(t):n}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!==(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(e){var t,n,r=8,i=8;for(t=0;t<e;t++)0!==i&&(n=this.readEG(),i=(r+n+256)%256),r=0===i?r:i}},{key:"readSPS",value:function(){var e,t,n,r,i,a,o,s=0,c=0,u=0,l=0,f=1;if(this.readUByte(),e=this.readUByte(),this.readBits(5),this.skipBits(3),this.readUByte(),this.skipUEG(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var d=this.readUEG();if(3===d&&this.skipBits(1),this.skipUEG(),this.skipUEG(),this.skipBits(1),this.readBoolean())for(a=3!==d?8:12,o=0;o<a;o++)this.readBoolean()&&(o<6?this.skipScalingList(16):this.skipScalingList(64))}this.skipUEG();var p=this.readUEG();if(0===p)this.readUEG();else if(1===p)for(this.skipBits(1),this.skipEG(),this.skipEG(),t=this.readUEG(),o=0;o<t;o++)this.skipEG();if(this.skipUEG(),this.skipBits(1),n=this.readUEG(),r=this.readUEG(),i=this.readBits(1),0===i&&this.skipBits(1),this.skipBits(1),this.readBoolean()&&(s=this.readUEG(),c=this.readUEG(),u=this.readUEG(),l=this.readUEG()),this.readBoolean()&&this.readBoolean()){var h,m=this.readUByte();switch(m){case 1:h=[1,1];break;case 2:h=[12,11];break;case 3:h=[10,11];break;case 4:h=[16,11];break;case 5:h=[40,33];break;case 6:h=[24,11];break;case 7:h=[20,11];break;case 8:h=[32,11];break;case 9:h=[80,33];break;case 10:h=[18,11];break;case 11:h=[15,11];break;case 12:h=[64,33];break;case 13:h=[160,99];break;case 14:h=[4,3];break;case 15:h=[3,2];break;case 16:h=[2,1];break;case 255:h=[this.readUByte()<<8|this.readUByte(),this.readUByte()<<8|this.readUByte()];break}h&&(f=h[0]/h[1])}return{width:Math.ceil((16*(n+1)-2*s-2*c)*f),height:(2-i)*(r+1)*16-(i?2:4)*(u+l)}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}(),c=s;n.default=c},{"../utils/logger":16}],6:[function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;e("../errors");var i=c(e("../events")),a=c(e("./exp-golomb")),o=c(e("../event-handler")),s=c(e("../remux/mp4-remuxer"));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function h(e){var t=g();return function(){var n,r=v(e);if(t){var i=v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var b=function(e){d(n,e);var t=h(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;u(this,n),r=t.call(this,e,i.default.H264_DATA_PARSING),r.config=r.wfs.config||a,r.wfs=e,r.id="main";MediaSource.isTypeSupported("video/mp4");return r.remuxer=new s.default(r.wfs,r.id,r.config),r.contiguous=!0,r.timeOffset=1,r.sn=0,r.TIMESCALE=9e4,r.timestamp=0,r.scaleFactor=r.TIMESCALE/1e3,r.H264_TIMEBASE=r.config.mp4Duration,r._avcTrack={container:"video/mp4",type:"video",id:1,sequenceNumber:0,samples:[],len:0,nbNalu:0,dropped:0,count:0},r.browserType=0,-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&(r.browserType=1),r}return f(n,[{key:"destroy",value:function(){o.default.prototype.destroy.call(this)}},{key:"getTimestampM",value:function(){return this.timestamp+=this.H264_TIMEBASE,this.timestamp}},{key:"onH264DataParsing",value:function(e){this._parseAVCTrack(e.data),this.browserType,this.remuxer.pushVideo(0,this.sn,this._avcTrack,this.timeOffset,this.contiguous),this.sn+=1}},{key:"_parseAVCTrack",value:function(e){var t,n,r,o,s=this,c=this._avcTrack,u=c.samples,l=this._parseAVCNALu(e),f=[],d=!1,p=!1,h=0,m="",y=function(){if(f.length){if(!this.config.forceKeyFrameOnDiscontinuity||!0===p||c.sps&&(u.length||this.contiguous)){var e=this.getTimestampM();n={units:{units:f,length:h},pts:e,dts:e,key:p},u.push(n),c.len+=h,c.nbNalu+=f.length}else c.dropped++;f=[],h=0}}.bind(this);l.forEach((function(e){switch(e.type){case 1:r=!0,d&&(m+="NDR ");break;case 5:r=!0,d&&(m+="IDR "),p=!0;break;case 6:e.data=s.discardEPB(e.data),t=new a.default(e.data),t.readUByte();break;case 7:if(r=!1,d&&(m+="SPS "),!c.sps){t=new a.default(e.data);var n=t.readSPS();c.width=n.width,c.height=n.height,c.sps=[e.data],c.duration=0;var u=e.data.subarray(1,4),l="avc1.";for(o=0;o<3;o++){var g=u[o].toString(16);g.length<2&&(g="0"+g),l+=g}c.codec=l,s.wfs.trigger(i.default.BUFFER_RESET,{mimeType:c.codec}),r=!0}break;case 8:r=!1,d&&(m+="PPS "),c.pps||(c.pps=[e.data],r=!0);break;case 9:r=!1,d&&(m+="AUD "),y();break;default:r=!1,m+="unknown NAL "+e.type+" ";break}r&&(f.push(e),h+=e.data.byteLength)})),(d||m.length)&&logger.log(m),y()}},{key:"_parseAVCNALu",value:function(e){var t,n,r,i,a,o=0,s=e.byteLength,c=0,u=[];while(o<s)switch(t=e[o++],c){case 0:0===t&&(c=1);break;case 1:c=0===t?2:0;break;case 2:case 3:0===t?c=3:1===t&&o<s?(r=31&e[o],i&&(n={data:e.subarray(i,o-c-1),type:a},u.push(n)),i=o,a=r,c=0):c=0;break;default:break}return i&&(n={data:e.subarray(i,s),type:a,state:c},u.push(n)),u}},{key:"discardEPB",value:function(e){var t,n,r=e.byteLength,i=[],a=1;while(a<r-2)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),n[a]=e[o];return n}}]),n}(o.default),_=b;n.default=_},{"../errors":7,"../event-handler":8,"../events":9,"../remux/mp4-remuxer":15,"./exp-golomb":5}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ErrorTypes=n.ErrorDetails=void 0;var r={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",OTHER_ERROR:"otherError"};n.ErrorTypes=r;var i={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",INTERNAL_EXCEPTION:"internalException",NETWORK_RECV_DATA_TIMEOUT:"networkRecvDataTimeout"};n.ErrorDetails=i},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;r(e("./events"));function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var c=function(){function e(t){a(this,e),this.wfs=t,this.onEvent=this.onEvent.bind(this);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}return s(e,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===i(this.handledEvents)&&this.handledEvents.length&&"function"===typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.wfs.on(e,this.onEvent)}.bind(this))}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.wfs.off(e,this.onEvent)}.bind(this))}},{key:"onEvent",value:function(e,t){this.onEventGeneric(e,t)}},{key:"onEventGeneric",value:function e(t,n){var r=function(e,t){var n="on"+e.replace("wfs","");return this[n],this[n].bind(this,t)};try{r.call(this,t,n).call()}catch(e){console.log("internal error happened while processing ".concat(t,":").concat(e.message))}}}]),e}(),u=c;n.default=u},{"./events":9}],9:[function(e,t,n){"use strict";t.exports={MEDIA_ATTACHING:"wfsMediaAttaching",MEDIA_ATTACHED:"wfsMediaAttached",FRAG_LOADING:"wfsFragLoading",BUFFER_CREATED:"wfsBufferCreated",BUFFER_APPENDING:"wfsBufferAppending",BUFFER_RESET:"wfsBufferReset",FRAG_PARSING_DATA:"wfsFragParsingData",FRAG_PARSING_INIT_SEGMENT:"wfsFragParsingInitSegment",H264_DATA_PARSING:"wfsH264DataParsing",WEBSOCKET_ATTACHED:"wfsWebsocketAttached",WEBSOCKET_ATTACHING:"wfsWebsocketAttaching",WEBSOCKET_DATA_UPLOADING:"wfsWebsocketDataUploading",WEBSOCKET_MESSAGE_SENDING:"wfsWebsocketMessageSending",FILE_HEAD_LOADING:"wfsFileHeadLoading",FILE_HEAD_LOADED:"wfsFileHeadLoaded",FILE_DATA_LOADING:"wfsFileDataLoading",FILE_DATA_LOADED:"wfsFileDataLoaded",FILE_PARSING_DATA:"wfsFileParsingData",RECORDING_START:"wfsRecordingStart",RECORDING_STOP:"wfsRecordingStop",ERROR:"wfsError"}},{}],10:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=function(){function e(){r(this,e)}return a(e,null,[{key:"getSilentFrame",value:function(e){return 1===e?new Uint8Array([0,200,0,128,35,128]):2===e?new Uint8Array([33,0,73,144,2,25,0,35,128]):3===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]):4===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]):5===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]):6===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]):null}}]),e}(),s=o;n.default=s},{}],11:[function(e,t,n){"use strict";t.exports=e("./wfs.js").default},{"./wfs.js":19}],12:[function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(e("../events")),a=o(e("../event-handler"));function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function d(e){var t=m();return function(){var n,r=y(e);if(t){var i=y(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}function p(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var g=function(e){l(n,e);var t=d(n);function n(e){var r;return s(this,n),r=t.call(this,e,i.default.FRAG_LOADING,i.default.FILE_HEAD_LOADING,i.default.FILE_DATA_LOADING),r.loaders={},r}return u(n,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},a.default.prototype.destroy.call(this)}},{key:"onFileHeadLoading",value:function(e){var t,n,r,i=this.wfs.config,a=new i.loader(i);t={url:i.fmp4FileUrl},n={maxRetry:0,retryDelay:0},r={onSuccess:this.fileloadheadsuccess.bind(this)},a.loadHead(t,n,r)}},{key:"fileloadheadsuccess",value:function(e){this.wfs.trigger(i.default.FILE_HEAD_LOADED,{size:e})}},{key:"onFileDataLoading",value:function(e){var t,n,r,i=this.wfs.config,a=new i.loader(i);t={url:i.fmp4FileUrl,responseType:"arraybuffer",progressData:!1};var o=e.fileStart,s=e.fileEnd;isNaN(o)||isNaN(s)||(t.rangeStart=o,t.rangeEnd=s),n={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},r={onSuccess:this.fileloaddatasuccess.bind(this)},a.load(t,n,r)}},{key:"fileloaddatasuccess",value:function(e,t,n){this.wfs.trigger(i.default.FILE_DATA_LOADED,{payload:e.data,stats:t})}},{key:"loaderror",value:function(e,t){var n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0}},{key:"loadtimeout",value:function(e,t){var n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0}},{key:"loadprogress",value:function(e,t,n){var r=t.frag;r.loaded=e.loaded}}]),n}(a.default),v=g;n.default=v},{"../event-handler":8,"../events":9}],13:[function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=e("../errors"),a=c(e("../events")),o=c(e("../event-handler")),s=c(e("../demux/h264-demuxer"));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function h(e){var t=g();return function(){var n,r=v(e);if(t){var i=v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var b=function(e){d(n,e);var t=h(n);function n(e){var r;return u(this,n),r=t.call(this,e,a.default.WEBSOCKET_ATTACHING,a.default.WEBSOCKET_DATA_UPLOADING,a.default.WEBSOCKET_MESSAGE_SENDING),r.buf=null,r.ctx=null,r.h264Demuxer=new s.default(e),r.websocketName=void 0,r.media=void 0,r.mediaType=void 0,r.mediaCode=0,r.channelName=void 0,r.isForceClosed=!1,r.timer=void 0,r.lastRecvDataTime=0,r.extraData=void 0,r.isLoaded=!1,r}return f(n,[{key:"create_timer",value:function(){var e=this;this.lastRecvDataTime=performance.now(),console.log("Websocket: create_timer"),this.timer=setInterval((function(){if(e.lastRecvDataTime>0){var t=performance.now(),n=t-e.lastRecvDataTime;if(n>e.wfs.config.wsMinPacketInterval&&console.log("Websocket: did not recv data over "+n+" ms"),n>e.wfs.config.wsMaxPacketInterval&&!e.isForceClosed){e.unload(),console.log("Websocket data not received in "+e.wfs.config.wsMaxPacketInterval/1e3+"s, open again...");var r={type:i.ErrorTypes.NETWORK_ERROR};r.details=i.ErrorDetails.NETWORK_RECV_DATA_TIMEOUT,r.fatal=!0,e.wfs.trigger(a.default.ERROR,r)}}else e.lastRecvDataTime=performance.now()}),this.wfs.config.wsMinPacketInterval)}},{key:"kill_timer",value:function(){this.timer&&(console.log("Websocket close: clear timer"),clearInterval(this.timer),this.timer=void 0)}},{key:"destroy",value:function(){this.kill_timer(),this.isForceClosed=!0,this.client&&this.client.close(),o.default.prototype.destroy.call(this)}},{key:"onWebsocketAttaching",value:function(e){switch(this.kill_timer(),this.create_timer(),e.mediaType){case"MJPEG":this.mediaCode=1,this.ctx=e.media.getContext("2d");break;case"H264Raw":default:this.mediaCode=0;break}this.websocketName=e.websocketName,this.media=e.media,this.mediaType=e.mediaType,this.channelName=e.channelName,this.extraData=e.extraData,e.websocket instanceof WebSocket&&(this.client=e.websocket,this.client.onopen=this.initSocketClient.bind(this),this.client.onclose=this.closeSocketClient.bind(this),this.client.onerror=this.errorSocketClient.bind(this))}},{key:"errorSocketClient",value:function(e){this.unload(),console.log("WebSocket error: ",e)}},{key:"closeSocketClient",value:function(e){this.unload(),console.log("Websocket closed: ",e)}},{key:"initSocketClient",value:function(e){this.load(),console.log("Websocket Open!")}},{key:"receiveSocketMessage",value:function(e){var t=this;if(document["hidden"])return console.log("wfs websocket: document.hidden return!"),void(this.isLoaded&&(this.lastRecvDataTime=performance.now()));if(this.isLoaded)if(this.lastRecvDataTime=performance.now(),0===this.mediaCode){this.buf=new Uint8Array(e.data);var n=new Uint8Array(this.buf);this.wfs.trigger(a.default.H264_DATA_PARSING,{data:n})}else if(1===this.mediaCode)if(this.extraData){if(!this.extraData.isDrawImg)return;if(void 0==this.media||!this.media)return;var r=new FileReader;r.onload=function(e){if(e.target.readyState===FileReader.DONE){var n=t.ctx,r=new Image,i=t.extraData.mjpeg_w,a=t.extraData.mjpeg_h,o=t.extraData.sizeOptionInd,s=t.extraData.getObjectFitSize;r.onload=function(){if(n.clearRect(0,0,i,a),1===o){var e=s(o,i,a,this.width,this.height),t=e.sx,c=e.sy,u=e.swidth,l=e.sheight,f=e.x,d=e.y,p=e.width,h=e.height;n.drawImage(r,t,c,u,l,f,d,p,h)}else n.drawImage(r,0,0,i,a)},r.src=e.target.result}},r.readAsDataURL(e.data)}else console.log("extraData is undefined"),this.extraData=this.wfs.extraData}},{key:"onWebsocketDataUploading",value:function(e){this.client.send(e.data)}},{key:"onWebsocketMessageSending",value:function(e){this.client.send(JSON.stringify({t:e.commandType,c:e.channelName,v:e.commandValue}))}},{key:"load",value:function(){0===this.mediaCode&&(this.client.binaryType="arraybuffer"),this.client.onmessage=this.receiveSocketMessage.bind(this),this.wfs.trigger(a.default.WEBSOCKET_MESSAGE_SENDING,{commandType:"open",channelName:this.channelName,commandValue:"NA"}),this.isLoaded=!0}},{key:"unload",value:function(){this.isLoaded=!1,1===this.mediaCode&&this.ctx.clearRect(0,0,this.extraData.mjpeg_w,this.extraData.mjpeg_h)}}]),n}(o.default),_=b;n.default=_},{"../demux/h264-demuxer":6,"../errors":7,"../event-handler":8,"../events":9}],14:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=function(){function e(){r(this,e)}return a(e,null,[{key:"init",value:function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:n,audio:r};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),c=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,c,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))}},{key:"box",value:function(e){var t,n=Array.prototype.slice.call(arguments,1),r=8,i=n.length,a=i;while(i--)r+=n[i].byteLength;for(t=new Uint8Array(r),t[0]=r>>24&255,t[1]=r>>16&255,t[2]=r>>8&255,t[3]=255&r,t.set(e,4),i=0,r=8;i<a;i++)t.set(n[i],r),r+=n[i].byteLength;return t}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,n){return n*=t,e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,n,r){return e.box(e.types.moof,e.mfhd(t),e.traf(r,n))}},{key:"moov",value:function(t){var n=t.length,r=[];while(n--)r[n]=e.trak(t[n]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(e.mvex(t)))}},{key:"mvex",value:function(t){var n=t.length,r=[];while(n--)r[n]=e.trex(t[n]);return e.box.apply(null,[e.types.mvex].concat(r))}},{key:"mvhd",value:function(t,n){n=0;var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,r)}},{key:"sdtp",value:function(t){var n,r,i=t.samples||[],a=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n=i[r].flags,a[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return e.box(e.types.sdtp,a)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var n,r,i,a=[],o=[];for(n=0;n<t.sps.length;n++)r=t.sps[n],i=r.byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(r));for(n=0;n<t.pps.length;n++)r=t.pps[n],i=r.byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(r));var s=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(o))),c=t.width,u=t.height;return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,255&c,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,106,101,102,102,45,121,97,110,47,47,47,103,119,102,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"esds",value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:"mp4a",value:function(t){var n=t.audiosamplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]),e.box(e.types.esds,e.esds(t)))}},{key:"stsd",value:function(t){return"audio"===t.type?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:"tkhd",value:function(t){var n=t.id,r=t.duration*t.timescale,i=t.width,a=t.height;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,a>>8&255,255&a,0,0]))}},{key:"traf",value:function(t,n){var r=e.sdtp(t),i=t.id;return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),e.box(e.types.tfdt,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),e.trun(t,r.length+16+16+8+16+8+8),r)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var n=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,n){var r,i,a,o,s,c,u=t.samples||[],l=u.length,f=12+16*l,d=new Uint8Array(f);for(n+=8+f,d.set([0,0,15,1,l>>>24&255,l>>>16&255,l>>>8&255,255&l,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0),r=0;r<l;r++)i=u[r],a=i.duration,o=i.size,s=i.flags,c=i.cts,d.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,c>>>24&255,c>>>16&255,c>>>8&255,255&c],12+16*r);return e.box(e.types.trun,d)}},{key:"initSegment",value:function(t){e.types||e.init();var n,r=e.moov(t);return n=new Uint8Array(e.FTYP.byteLength+r.byteLength),n.set(e.FTYP),n.set(r,e.FTYP.byteLength),n}}]),e}(),s=o;n.default=s},{}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=c(e("../helper/aac")),i=c(e("../events")),a=e("../utils/logger"),o=c(e("../remux/mp4-generator")),s=e("../errors");function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}e("../utils/polyfill");var d=function(){function e(t,n,r){u(this,e),this.observer=t,this.id=n,this.config=r,this.ISGenerated=!1,this.PES2MP4SCALEFACTOR=4,this.PES_TIMESCALE=9e4,this.MP4_TIMESCALE=this.PES_TIMESCALE/this.PES2MP4SCALEFACTOR,this.nextAvcDts=90300,this.H264_TIMEBASE=this.config.mp4Duration,this.genISFailCount=0}return f(e,[{key:"passthrough",get:function(){return!1}},{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){this._initPTS=this._initDTS=void 0}},{key:"switchLevel",value:function(){this.ISGenerated=!1,this.genISFailCount=0}},{key:"pushVideo",value:function(e,t,n,r,i){this.level=e,this.sn=t,this.ISGenerated||this.generateVideoIS(n,r),this.ISGenerated&&this.remuxVideo_2(n,r,i)}},{key:"remuxVideo_2",value:function(e,t,n,r){var s,c,u=8,l=e.samples,f=[];s=new Uint8Array(e.len+4*e.nbNalu+8);var d=new DataView(s.buffer);d.setUint32(0,s.byteLength),s.set(o.default.types.mdat,4);for(var p,h,m,y=0,g=0;g<l.length;g++){var v=l[g],b=0;while(v.units.units.length){var _=v.units.units.shift();d.setUint32(u,_.data.byteLength),u+=4,s.set(_.data,u),u+=_.data.byteLength,b+=4+_.data.byteLength}var w=v.pts-this._initPTS,E=v.dts-this._initDTS;if(E=Math.min(w,E),void 0!==m)p=this._PTSNormalize(w,m),h=this._PTSNormalize(E,m),y=h-m,y<=0&&(a.logger.log("invalid sample duration at PTS/DTS: ".concat(v.pts,"/").concat(v.dts,"|dts norm: ").concat(h,"|lastDTS: ").concat(m,":").concat(y)),y=1);else{var C,T=this.nextAvcDts;p=this._PTSNormalize(w,T),h=this._PTSNormalize(E,T),T&&(C=Math.round(h-T),Math.abs(C)<600&&C&&(C>1?a.logger.log("AVC:".concat(C," ms hole between fragments detected,filling it")):C<-1&&a.logger.log("AVC:".concat(-C," ms overlapping between fragments detected")),h=T,p=Math.max(p-C,h),a.logger.log("Video/PTS/DTS adjusted: ".concat(p,"/").concat(h,",delta:").concat(C)))),this.firstPTS=Math.max(0,p),this.firstDTS=Math.max(0,h),y=.03}f.push({size:b,duration:this.H264_TIMEBASE,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:v.key?2:1,isNonSync:v.key?0:1}}),m=h}var S=0;if(f.length>=2&&(S=f[f.length-2].duration,f[0].duration=S),this.nextAvcDts=h+S,e.len=0,e.nbNalu=0,e.dropped=0,f.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var I=f[0].flags;I.dependsOn=2,I.isNonSync=0}e.samples=f,c=o.default.moof(e.sequenceNumber++,h,e),e.samples=[];var k={data1:c,data2:s,type:"video"};return this.observer.trigger(i.default.FRAG_PARSING_DATA,k),k}},{key:"generateVideoIS",value:function(e,t){var n,r,a=this.observer,c=e.samples,u=(this.PES_TIMESCALE,{}),l={id:this.id,level:this.level,sn:this.sn,tracks:u,unique:!1},f=void 0===this._initPTS;f&&(n=r=1/0),e.sps&&e.pps&&c.length&&(e.timescale=9e4,u.video={container:"video/mp4",codec:e.codec,initSegment:o.default.initSegment([e]),metadata:{width:e.width,height:e.height}},f&&(n=Math.min(n,c[0].pts-this.H264_TIMEBASE),r=Math.min(r,c[0].dts-this.H264_TIMEBASE))),Object.keys(u).length?(a.trigger(i.default.FRAG_PARSING_INIT_SEGMENT,l),this.ISGenerated=!0,this.genISFailCount=0,f&&(this._initPTS=n,this._initDTS=r)):(this.genISFailCount++,this.genISFailCount>60&&console.log("generateVideoIS ERROR: ",s.ErrorTypes.MEDIA_ERROR))}},{key:"remux",value:function(e,t,n,r,a,o,s,c){if(this.level=e,this.sn=t,this.ISGenerated||this.generateIS(n,r,s),this.ISGenerated)if(n.samples.length){var u,l=this.remuxAudio(n,s,c);if(r.samples.length)l&&(u=l.endPTS-l.startPTS),this.remuxVideo(r,s,c,u)}else{var f;r.samples.length&&(f=this.remuxVideo(r,s,c)),f&&n.codec&&this.remuxEmptyAudio(n,s,c,f)}a.samples.length&&this.remuxID3(a,s),o.samples.length&&this.remuxText(o,s),this.observer.trigger(i.default.FRAG_PARSED,{id:this.id,level:this.level,sn:this.sn})}},{key:"generateIS",value:function(e,t,n){var r,c,u=this.observer,l=e.samples,f=t.samples,d=this.PES_TIMESCALE,p={},h={id:this.id,level:this.level,sn:this.sn,tracks:p,unique:!1},m=void 0===this._initPTS;if(m&&(r=c=1/0),e.config&&l.length){if(e.timescale=e.audiosamplerate,e.timescale*e.duration>Math.pow(2,32)){var y=function e(t,n){return n?e(n,t%n):t};e.timescale=e.audiosamplerate/y(e.audiosamplerate,1024)}a.logger.log("audio mp4 timescale :"+e.timescale),p.audio={container:"audio/mp4",codec:e.codec,initSegment:o.default.initSegment([e]),metadata:{channelCount:e.channelCount}},m&&(r=c=l[0].pts-d*n)}t.sps&&t.pps&&f.length&&(t.timescale=this.MP4_TIMESCALE,p.video={container:"video/mp4",codec:t.codec,initSegment:o.default.initSegment([t]),metadata:{width:t.width,height:t.height}},m&&(r=Math.min(r,f[0].pts-d*n),c=Math.min(c,f[0].dts-d*n))),Object.keys(p).length?(u.trigger(i.default.FRAG_PARSING_INIT_SEGMENT,h),this.ISGenerated=!0,m&&(this._initPTS=r,this._initDTS=c)):u.trigger(i.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,id:this.id,details:s.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(e,t,n,r){var s,c,u,l,f,d,p,h,m=8,y=this.PES_TIMESCALE,g=this.PES2MP4SCALEFACTOR,v=e.samples,b=[];h=n?this.nextAvcDts:t*y;var _=v[0];f=Math.max(this._PTSNormalize(_.dts,h)-this._initDTS,0),l=Math.max(this._PTSNormalize(_.pts,h)-this._initDTS,0);var w=Math.round((f-h)/90);n&&w&&(w>1?a.logger.log("AVC:".concat(w," ms hole between fragments detected,filling it")):w<-1&&a.logger.log("AVC:".concat(-w," ms overlapping between fragments detected")),f=h,v[0].dts=f+this._initDTS,l=Math.max(l-w,h),v[0].pts=l+this._initDTS,a.logger.log("Video/PTS/DTS adjusted: ".concat(l,"/").concat(f,",delta:").concat(w))),_=v[v.length-1],p=Math.max(this._PTSNormalize(_.dts,h)-this._initDTS,0),d=Math.max(this._PTSNormalize(_.pts,h)-this._initDTS,0),d=Math.max(d,p);var E=navigator.vendor,C=navigator.userAgent,T=E&&E.indexOf("Apple")>-1&&C&&!C.match("CriOS");T&&(s=Math.round((p-f)/(g*(v.length-1))));for(var S=0;S<v.length;S++){var I=v[S];T?I.dts=f+S*g*s:(I.dts=Math.max(this._PTSNormalize(I.dts,h)-this._initDTS,f),I.dts=Math.round(I.dts/g)*g),I.pts=Math.max(this._PTSNormalize(I.pts,h)-this._initDTS,I.dts),I.pts=Math.round(I.pts/g)*g}c=new Uint8Array(e.len+4*e.nbNalu+8);var k=new DataView(c.buffer);k.setUint32(0,c.byteLength),c.set(o.default.types.mdat,4);for(var A=0;A<v.length;A++){var R=v[A],x=0,O=void 0;while(R.units.units.length){var F=R.units.units.shift();k.setUint32(m,F.data.byteLength),m+=4,c.set(F.data,m),m+=F.data.byteLength,x+=4+F.data.byteLength}if(T)O=Math.max(0,s*Math.round((R.pts-R.dts)/(g*s)));else{if(A<v.length-1)s=v[A+1].dts-R.dts;else{var P=this.config,D=R.dts-v[A>0?A-1:A].dts;if(P.stretchShortVideoTrack){var U=P.maxBufferHole,L=P.maxSeekHole,M=Math.floor(Math.min(U,L)*y),N=(r?l+r*y:this.nextAacPts)-R.pts;N>M?(s=N-D,s<0&&(s=D),a.logger.log("It is approximately ".concat(N/90," ms to the next segment; using duration ").concat(s/90," ms for the last video frame."))):s=D}else s=D}s/=g,O=Math.round((R.pts-R.dts)/g)}b.push({size:x,duration:s,cts:O,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:R.key?2:1,isNonSync:R.key?0:1}})}this.nextAvcDts=p+s*g;var B=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,b.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var H=b[0].flags;H.dependsOn=2,H.isNonSync=0}e.samples=b,u=o.default.moof(e.sequenceNumber++,f/g,e),e.samples=[];var j={id:this.id,level:this.level,sn:this.sn,data1:u,data2:c,startPTS:l/y,endPTS:(d+g*s)/y,startDTS:l/y,endDTS:(d+g*s)/y,type:"video",nb:b.length,dropped:B};return this.observer.trigger(i.default.FRAG_PARSING_DATA,j),j}},{key:"remuxAudio",value:function(e,t,n){var s,c,u,l,f,d,p,h,m,y,g,v,b,_=this.PES_TIMESCALE,w=e.timescale,E=_/w,C=1024*e.timescale/e.audiosamplerate,T=8,S=[],I=[];e.samples.sort((function(e,t){return e.pts-t.pts})),I=e.samples;for(var k=n?this.nextAacPts:t*_,A=this._PTSNormalize(I[0].pts-this._initPTS,k),R=C*E,x=A+R,O=1;O<I.length;){var F=I[O],P=this._PTSNormalize(F.pts-this._initPTS,k),D=P-x;if(D<-.5*R)a.logger.log("Dropping frame due to ".concat(Math.abs(D/90)," ms overlap.")),I.splice(O,1),e.len-=F.unit.length;else if(D>.5*R){var U=Math.round(D/R);a.logger.log("Injecting ".concat(U," frame").concat(U>1?"s":""," of missing audio due to ").concat(Math.round(D/90)," ms gap."));for(var L=0;L<U;L++){var M=I[O-1].pts+R,N=r.default.getSilentFrame(e.channelCount);N||(a.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),N=F.unit.slice(0)),I.splice(O,0,{unit:N,pts:M,dts:M}),e.len+=N.length,O+=1}x+=(U+1)*R,F.pts=I[O-1].pts+R,O+=1}else Math.abs(D)>.1*R&&a.logger.log("Invalid frame delta ".concat(P-x+R," at PTS ").concat(Math.round(P/90)," (should be ").concat(R,").")),x+=R,F.pts=I[O-1].pts+R,O+=1}while(I.length){if(c=I.shift(),l=c.unit,y=c.pts-this._initDTS,g=c.dts-this._initDTS,void 0!==m)v=this._PTSNormalize(y,m),b=this._PTSNormalize(g,m),u.duration=(b-m)/E;else{v=this._PTSNormalize(y,k),b=this._PTSNormalize(g,k);var B=Math.round(1e3*(v-k)/_);if(n&&B){if(B>0)a.logger.log("".concat(B," ms hole between AAC samples detected,filling it"));else if(B<-12){a.logger.log("".concat(-B," ms overlapping between AAC samples detected, drop frame")),e.len-=l.byteLength;continue}v=b=k}if(p=Math.max(0,v),h=Math.max(0,b),!(e.len>0))return;f=new Uint8Array(e.len+8),s=new DataView(f.buffer),s.setUint32(0,f.byteLength),f.set(o.default.types.mdat,4)}f.set(l,T),T+=l.byteLength,u={size:l.byteLength,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},S.push(u),m=b}var H=0,j=S.length;if(j>=2&&(H=S[j-2].duration,u.duration=H),j){this.nextAacPts=v+E*H,e.len=0,e.samples=S,d=o.default.moof(e.sequenceNumber++,h/E,e),e.samples=[];var V={id:this.id,level:this.level,sn:this.sn,data1:d,data2:f,startPTS:p/_,endPTS:this.nextAacPts/_,startDTS:h/_,endDTS:(b+E*H)/_,type:"audio",nb:j};return this.observer.trigger(i.default.FRAG_PARSING_DATA,V),V}return null}},{key:"remuxEmptyAudio",value:function(e,t,n,i){var o=this.PES_TIMESCALE,s=e.timescale?e.timescale:e.audiosamplerate,c=o/s,u=i.startDTS*o+this._initDTS,l=i.endDTS*o+this._initDTS,f=1024,d=c*f,p=Math.ceil((l-u)/d),h=r.default.getSilentFrame(e.channelCount);if(h){for(var m=[],y=0;y<p;y++){var g=u+y*d;m.push({unit:h.slice(0),pts:g,dts:g}),e.len+=h.length}e.samples=m,this.remuxAudio(e,t,n)}else a.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")}},{key:"remuxID3",value:function(e,t){var n,r=e.samples.length;if(r){for(var a=0;a<r;a++)n=e.samples[a],n.pts=(n.pts-this._initPTS)/this.PES_TIMESCALE,n.dts=(n.dts-this._initDTS)/this.PES_TIMESCALE;this.observer.trigger(i.default.FRAG_PARSING_METADATA,{id:this.id,level:this.level,sn:this.sn,samples:e.samples})}e.samples=[],t=t}},{key:"remuxText",value:function(e,t){e.samples.sort((function(e,t){return e.pts-t.pts}));var n,r=e.samples.length;if(r){for(var a=0;a<r;a++)n=e.samples[a],n.pts=(n.pts-this._initPTS)/this.PES_TIMESCALE;this.observer.trigger(i.default.FRAG_PARSING_USERDATA,{id:this.id,level:this.level,sn:this.sn,samples:e.samples})}e.samples=[],t=t}},{key:"_PTSNormalize",value:function(e,t){var n;if(void 0===t)return e;n=t<e?-8589934592:8589934592;while(Math.abs(e-t)>4294967296)e+=n;return e}}]),e}(),p=d;n.default=p},{"../errors":7,"../events":9,"../helper/aac":10,"../remux/mp4-generator":14,"../utils/logger":16,"../utils/polyfill":17}],16:[function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(){}Object.defineProperty(n,"__esModule",{value:!0}),n.logger=n.enableLogs=void 0;var a={trace:i,debug:i,log:i,warn:i,info:i,error:i},o=a;function s(e,t){return t="["+e+"] > "+t,t}function c(e){var t=window.console[e];return t?function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];r[0]&&(r[0]=s(e,r[0])),t.apply(window.console,r)}:i}function u(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach((function(t){o[t]=e[t]?e[t].bind(e):c(t)}))}var l=function(t){if(!0===t||"object"===r(t)){u(t,"debug","log","info","warn","error");try{o.log()}catch(e){o=a}}else o=a};n.enableLogs=l;var f=o;n.logger=f},{}],17:[function(e,t,n){"use strict";"undefined"===typeof ArrayBuffer||ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,t){var n=new Uint8Array(this);void 0===t&&(t=n.length);for(var r=new ArrayBuffer(t-e),i=new Uint8Array(r),a=0;a<i.length;a++)i[a]=n[a+e];return r})},{}],18:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=function(){function e(t){r(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return a(e,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"loadHead",value:function(e,t,n){this.context=e,this.config=t,this.callbacks=n,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay;var r=new XMLHttpRequest;r.open("head",e.url),r.onload=function(){n.onSuccess(r.getResponseHeader("content-length"))},r.send()}},{key:"load",value:function(e,t,n){this.context=e,this.config=t,this.callbacks=n,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()}},{key:"loadInternal",value:function(){var e,t=this.context;e="undefined"!==typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest,e.onloadend=this.loadend.bind(this),e.onprogress=this.loadprogress.bind(this),e.open("GET",t.url,!0),t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.responseType=t.responseType;var n=this.stats;n.tfirst=0,n.loaded=0,this.xhrSetup&&this.xhrSetup(e,t.url),this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()}},{key:"loadend",value:function(e){var t=e.currentTarget,n=t.status,r=this.stats,i=this.context,a=this.config;if(!r.aborted)if(window.clearTimeout(this.requestTimeout),n>=200&&n<300){var o,s;r.tload=Math.max(r.tfirst,performance.now()),"arraybuffer"===i.responseType?(o=t.response,s=o.byteLength):(o=t.responseText,s=o.length),r.loaded=r.total=s;var c={url:t.responseURL,data:o};this.callbacks.onSuccess(c,r,i)}else r.retry>=a.maxRetry||n>=400&&n<499?this.callbacks.onError({code:n,text:t.statusText},i):(this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),r.retry++)}},{key:"loadtimeout",value:function(){this.callbacks.onTimeout(this.stats,this.context)}},{key:"loadprogress",value:function(e){var t=this.stats;0===t.tfirst&&(t.tfirst=Math.max(performance.now(),t.trequest)),t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total);var n=this.callbacks.onProgress;n&&n(t,this.context,null)}}]),e}(),s=o;n.default=s},{}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("./errors"),i=l(e("./events")),a=l(e("./controller/flow-controller")),o=l(e("./controller/buffer-controller")),s=l(e("events")),c=l(e("./utils/xhr-loader")),u=(l(e("./loader/file-loader")),l(e("./loader/websocket-loader")));function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f(this,e);var n=e.DefaultConfig;for(var r in n)r in t||(t[r]=n[r]);this.config=t;var i=this.observer=new s.default;i.trigger=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i.emit.apply(i,[e,e].concat(n))},i.off=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i.removeListener.apply(i,[e].concat(n))},this.on=i.on.bind(i),this.off=i.off.bind(i),this.trigger=i.trigger.bind(i),this.flowController=new a.default(this),this.bufferController=new o.default(this),this.websocketLoader=new u.default(this),this.mediaType=void 0,this.extraData=void 0}return p(e,[{key:"destroy",value:function(){console.log("wfs destroy +++"),this.flowController.destroy(),this.bufferController.destroy(),this.websocketLoader.destroy(),console.log("wfs destroy ---")}},{key:"attachMedia",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"chX",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"H264Raw",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"play2",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;this.mediaType=n,this.media=e,this.extraData=a;var o=void 0;switch(n){case"MJPEG":o=i.default.MEDIA_ATTACHED;break;case"H264Raw":default:o=i.default.MEDIA_ATTACHING;break}this.trigger(o,{media:e,channelName:t,mediaType:n,websocketName:r,extraData:this.extraData})}},{key:"attachWebsocket",value:function(e,t,n){this.trigger(i.default.WEBSOCKET_ATTACHING,{websocket:e,websocketName:t,media:this.media,mediaType:this.mediaType,channelName:n,extraData:this.extraData})}},{key:"start_recording",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1073741824,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.trigger(i.default.RECORDING_START,{rec_file_threshold:e,result_cb:t,state_cb:n})}},{key:"stop_recording",value:function(){this.trigger(i.default.RECORDING_STOP)}}],[{key:"version",get:function(){return"v.0.0.0.1"}},{key:"isSupported",value:function(){return window.MediaSource&&"function"===typeof window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42c01f,mp4a.40.2"')}},{key:"Events",get:function(){return i.default}},{key:"ErrorTypes",get:function(){return r.ErrorTypes}},{key:"ErrorDetails",get:function(){return r.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig||(e.defaultConfig={autoStartLoad:!0,startPosition:-1,debug:!1,fLoader:void 0,loader:c.default,fmp4FileUrl:"xxxx.mp4",fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,forceKeyFrameOnDiscontinuity:!0,appendErrorMaxRetry:3,wsMinPacketInterval:3e3,wsMaxPacketInterval:3e4,mp4Duration:1e3}),e.defaultConfig},set:function(t){e.defaultConfig=t}}]),e}(),m=h;n.default=m},{"./controller/buffer-controller":2,"./controller/flow-controller":4,"./errors":7,"./events":9,"./loader/file-loader":12,"./loader/websocket-loader":13,"./utils/xhr-loader":18,events:1}]},{},[11])(11)}))},d139:function(e,t,n){"use strict";var r=n("ebb5"),i=n("b727").find,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("find",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0)}))},d58f:function(e,t,n){var r=n("da84"),i=n("59ed"),a=n("7b0b"),o=n("44ad"),s=n("07fa"),c=r.TypeError,u=function(e){return function(t,n,r,u){i(n);var l=a(t),f=o(l),d=s(l),p=e?d-1:0,h=e?-1:1;if(r<2)while(1){if(p in f){u=f[p],p+=h;break}if(p+=h,e?p<0:d<=p)throw c("Reduce of empty array with no initial value")}for(;e?p>=0:d>p;p+=h)p in f&&(u=n(u,f[p],p,l));return u}};e.exports={left:u(!1),right:u(!0)}},d5d6:function(e,t,n){"use strict";var r=n("ebb5"),i=n("b727").forEach,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("forEach",(function(e){i(a(this),e,arguments.length>1?arguments[1]:void 0)}))},d784:function(e,t,n){"use strict";n("ac1f");var r=n("e330"),i=n("6eeb"),a=n("9263"),o=n("d039"),s=n("b622"),c=n("9112"),u=s("species"),l=RegExp.prototype;e.exports=function(e,t,n,f){var d=s(e),p=!o((function(){var t={};return t[d]=function(){return 7},7!=""[e](t)})),h=p&&!o((function(){var t=!1,n=/a/;return"split"===e&&(n={},n.constructor={},n.constructor[u]=function(){return n},n.flags="",n[d]=/./[d]),n.exec=function(){return t=!0,null},n[d](""),!t}));if(!p||!h||n){var m=r(/./[d]),y=t(d,""[e],(function(e,t,n,i,o){var s=r(e),c=t.exec;return c===a||c===l.exec?p&&!o?{done:!0,value:m(t,n,i)}:{done:!0,value:s(n,t,i)}:{done:!1}}));i(String.prototype,e,y[0]),i(l,d,y[1])}f&&c(l[d],"sham",!0)}},d998:function(e,t,n){var r=n("342f");e.exports=/MSIE|Trident/.test(r)},dfb9:function(e,t){e.exports=function(e,t){var n=0,r=t.length,i=new e(r);while(r>n)i[n]=t[n++];return i}},e58c:function(e,t,n){"use strict";var r=n("2ba4"),i=n("fc6a"),a=n("5926"),o=n("07fa"),s=n("a640"),c=Math.min,u=[].lastIndexOf,l=!!u&&1/[1].lastIndexOf(1,-0)<0,f=s("lastIndexOf"),d=l||!f;e.exports=d?function(e){if(l)return r(u,this,arguments)||0;var t=i(this),n=o(t),s=n-1;for(arguments.length>1&&(s=c(s,a(arguments[1]))),s<0&&(s=n+s);s>=0;s--)if(s in t&&t[s]===e)return s||0;return-1}:u},e6c4:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"total_container"},[n("el-container",{class:"ai"==e.mode_option?"preview_outside_container":"preview_outside_container_normal"},[n("el-container",{staticClass:"preview_main_container"},[n("el-main",{staticClass:"preview_capture_left_container"},[n("el-container",{staticClass:"preview_container"},[n("el-main",{ref:"axMain",staticClass:"video_container"},[n("video",{ref:"axVideoRef",staticClass:"axVideo",attrs:{id:"myVideo",autoplay:"",muted:"",playsinline:"",oncontextmenu:"return false;"},domProps:{muted:!0}})]),n("el-footer",{staticClass:"video_controls_container",attrs:{height:"30px"}},[n("div",{staticClass:"left_controls_container"},[n("div",{staticClass:"size_option"},[n("el-dropdown",{attrs:{size:"mini",placement:"top",trigger:"click"},on:{command:e.changeSizeOption}},[n("el-button",{staticClass:"el-dropdown-link",attrs:{size:"mini",type:"text"}},[e._v(e._s(e.sizeOptions[e.sizeOptionInd].label))]),n("el-dropdown-menu",{attrs:{slot:"dropdown","append-to-body":!1},slot:"dropdown"},e._l(e.sizeOptions,(function(t){return n("el-dropdown-item",{key:t.id,attrs:{command:t.id+"",icon:t.icon}},[e._v(e._s(t.label))])})),1)],1)],1),n("div",[n("el-dropdown",{attrs:{size:"mini",placement:"top",trigger:"click"},on:{command:e.changeStream}},[n("el-button",{staticClass:"el-dropdown-link",attrs:{size:"mini",type:"text"}},[e._v(e._s(e.streamOptions[e.streamOptionInd].label))]),n("el-dropdown-menu",{attrs:{slot:"dropdown","append-to-body":!1},slot:"dropdown"},e._l(e.streamOptions,(function(t){return n("el-dropdown-item",{key:t.id,attrs:{command:t.id+"",icon:t.icon}},[e._v(e._s(t.label))])})),1)],1)],1),n("div",{staticClass:"size_info"},[n("span",[e._v(e._s(this.enc_info))])])]),n("div",{staticClass:"right_controls_container"},[n("div",{staticClass:"draw_option"},[n("el-tooltip",{attrs:{effect:"dark",content:"抓拍",placement:"top-end",enterable:!1}},[n("el-button",{class:{draw_button_enable:!0,draw_button_disable:!1},attrs:{size:"mini",icon:"el-icon-camera-solid"},on:{click:e.onSnapshot}})],1)],1),n("div",{staticClass:"draw_option"},[n("el-tooltip",{attrs:{effect:"dark",content:"录入人像信息",placement:"top-end",enterable:!1}},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isSearchImg&&"facehuman"==e.detect_mode,expression:"isSearchImg && detect_mode == 'facehuman'"}],class:{draw_button_enable:!0,draw_button_disable:!1},attrs:{size:"mini",icon:"el-icon-user-solid"},on:{click:e.recordFaceinfo}})],1)],1),n("div",{staticClass:"draw_option"},[n("el-tooltip",{attrs:{effect:"dark",content:e.isRecStart?"停止录像":"开启录像",placement:"top-end",enterable:!1}},[n("el-button",{class:{draw_button_enable:!e.isRecStart,draw_button_disable:e.isRecStart},attrs:{size:"mini",disabled:!1===e.rec_enable,icon:"el-icon-video-camera-solid"},on:{click:e.onRecording}})],1)],1),n("div",{staticClass:"full_option"},[n("el-tooltip",{attrs:{effect:"dark",content:e.isFullScreen?"退出全屏":"进入全屏",placement:"top-end",enterable:!1}},[n("el-button",{staticClass:"full_button",attrs:{size:"mini",icon:e.screenIcon},on:{click:e.doScreen}})],1)],1)])])],1)],1),n("el-aside",{directives:[{name:"show",rawName:"v-show",value:"ai"==e.mode_option,expression:"mode_option == 'ai'"}],staticClass:"side_identify_events_container",attrs:{width:"320px"}},[n("el-container",{staticClass:"identify_events_container"},[n("el-header",{staticClass:"identify_container"},[n("el-row",{staticClass:"image_info_container"},[n("el-col",{staticClass:"image_col",attrs:{span:10}},[n("div",{staticClass:"image-large"},[""==e.currentImg.src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.currentImg.src?n("img",{staticClass:"image-large",attrs:{src:e.currentImg.src,crossOrigin:"anonymous"},on:{click:function(t){return e.look(e.currentImg)}}}):e._e()])]),n("el-col",{staticClass:"info_col",attrs:{span:14}},[n("div",{staticClass:"info_container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:"facehuman"==e.detect_mode,expression:"detect_mode == 'facehuman'"}],staticClass:"info_text"},[e._v(" 性别： "+e._s(e.currentImg.info.gender)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:"facehuman"==e.detect_mode,expression:"detect_mode == 'facehuman'"}],staticClass:"info_text"},[e._v(" 年龄： "+e._s(e.currentImg.info.age)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:"facehuman"==e.detect_mode,expression:"detect_mode == 'facehuman'"}],staticClass:"info_text"},[e._v(" 口罩： "+e._s(e.currentImg.info.mask)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:"facehuman"==e.detect_mode,expression:"detect_mode == 'facehuman'"}],staticClass:"info_text"},[e._v(" 识别： "+e._s(e.currentImg.info.info)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:"hvcfp"==e.detect_mode,expression:"detect_mode == 'hvcfp'"}],staticClass:"info_text"},[e._v(" 车牌号码："+e._s(e.currentImg.info.number)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:"hvcfp"==e.detect_mode,expression:"detect_mode == 'hvcfp'"}],staticClass:"info_text"},[e._v(" 车牌颜色："+e._s(e.currentImg.info.color)+" ")])])])],1)],1),n("el-main",{staticClass:"events_container"},[n("el-table",{staticClass:"events_table",staticStyle:{"font-size":"10px"},attrs:{"header-cell-style":{background:"#2C2C2C",color:"#B0B0B0",border:"none",fontSize:"10px",padding:"4px"},"cell-style":{padding:"4px"},"row-style":{height:"16px"},height:"150",data:e.eventList,"highlight-current-row":""}},[n("el-table-column",{attrs:{type:"index",label:"#",width:"60"}}),n("el-table-column",{attrs:{property:"date",label:"发生时间",width:"125"}}),n("el-table-column",{attrs:{property:"type",label:"事件类型",width:"125"}})],1)],1)],1)],1)],1),n("el-footer",{directives:[{name:"show",rawName:"v-show",value:"hvcfp"==e.detect_mode&&"ai"==e.mode_option,expression:"detect_mode == 'hvcfp' && mode_option == 'ai'"}],staticClass:"hvcfp_img_container"},[n("el-row",{staticClass:"img_list_top"},[n("el-col",{attrs:{span:2}},[n("div",{staticClass:"type_text"},[e._v("人脸")])]),n("el-col",{staticClass:"hvcfp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"hvcfp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.face[t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.face[t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.face[t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.face[t-1])}}}):e._e()])])})),1),n("el-col",{staticClass:"hvcfp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"hvcfp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.face[e.image_count/2+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.face[e.image_count/2+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.face[e.image_count/2+t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.face[e.image_count/2+t-1])}}}):e._e()])])})),1)],1),n("el-row",{staticClass:"img_list"},[n("el-col",{staticClass:"hvcfp_img_col",attrs:{span:2}},[n("div",{staticClass:"type_text"},[e._v("人形")])]),n("el-col",{staticClass:"hvcfp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"hvcfp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.body[t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.body[t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.body[t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.body[t-1])}}}):e._e()])])})),1),n("el-col",{staticClass:"hvcfp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"hvcfp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.body[e.image_count/2+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.body[e.image_count/2+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.body[e.image_count/2+t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.body[e.image_count/2+t-1])}}}):e._e()])])})),1)],1),n("el-row",{staticClass:"img_list"},[n("el-col",{staticClass:"hvcfp_img_col",attrs:{span:2}},[n("div",{staticClass:"type_text"},[e._v("非机动车")])]),n("el-col",{staticClass:"hvcfp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"hvcfp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.cycle[t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.cycle[t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.cycle[t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.cycle[t-1])}}}):e._e()])])})),1),n("el-col",{staticClass:"hvcfp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"hvcfp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.cycle[e.image_count/2+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.cycle[e.image_count/2+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.cycle[e.image_count/2+t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.cycle[e.image_count/2+t-1])}}}):e._e()])])})),1)],1),n("el-row",{staticClass:"img_list"},[n("el-col",{staticClass:"hvcfp_img_col",attrs:{span:2}},[n("div",{staticClass:"type_text"},[e._v("机动车")])]),n("el-col",{staticClass:"hvcfp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"hvcfp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.vechicle[t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.vechicle[t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.vechicle[t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.vechicle[t-1])}}}):e._e()])])})),1),n("el-col",{staticClass:"hvcfp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"hvcfp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.vechicle[e.image_count/2+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.vechicle[e.image_count/2+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.vechicle[e.image_count/2+t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.vechicle[e.image_count/2+t-1])}}}):e._e()])])})),1)],1),n("el-row",{staticClass:"img_list_bottom"},[n("el-col",{staticClass:"hvcfp_img_col",attrs:{span:2}},[n("div",{staticClass:"type_text"},[e._v("车牌")])]),n("el-col",{staticClass:"hvcfp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"hvcfp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.plate[t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.plate[t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.plate[t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.plate[t-1])}}}):e._e()])])})),1),n("el-col",{staticClass:"hvcfp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"hvcfp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.plate[e.image_count/2+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.plate[e.image_count/2+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.plate[e.image_count/2+t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.plate[e.image_count/2+t-1])}}}):e._e()])])})),1)],1)],1),n("el-footer",{directives:[{name:"show",rawName:"v-show",value:"facehuman"==e.detect_mode&&"ai"==e.mode_option,expression:"detect_mode == 'facehuman'  && mode_option == 'ai'"}],staticClass:"fh_img_container"},[n("el-row",{staticClass:"img_list_top"},[n("el-col",{staticClass:"fp_img_col",attrs:{span:2}},[n("div",{staticClass:"type_text_fh"},[e._v("人脸")])]),n("el-col",{staticClass:"fp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"fp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-medium"},[""==e.pushFHImages.face[t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.face[t-1].src?n("img",{staticClass:"image-medium",attrs:{src:e.pushFHImages.face[t-1].src},on:{click:function(n){return e.look(e.pushFHImages.face[t-1])}}}):e._e()])])})),1),n("el-col",{staticClass:"fp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"fp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-medium"},[""==e.pushFHImages.face[e.image_count/2+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.face[e.image_count/2+t-1].src?n("img",{staticClass:"image-medium",attrs:{src:e.pushFHImages.face[e.image_count/2+t-1].src},on:{click:function(n){return e.look(e.pushFHImages.face[e.image_count/2+t-1])}}}):e._e()])])})),1)],1),n("el-row",{staticClass:"img_list"},[n("el-col",{staticClass:"fp_img_col",attrs:{span:2}},[n("div",{staticClass:"type_text_fh"},[e._v("人脸")])]),n("el-col",{staticClass:"fp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"fp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-medium"},[""==e.pushFHImages.face[e.image_count+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.face[e.image_count+t-1].src?n("img",{staticClass:"image-medium",attrs:{src:e.pushFHImages.face[e.image_count+t-1].src},on:{click:function(n){return e.look(e.pushFHImages.face[e.image_count+t-1])}}}):e._e()])])})),1),n("el-col",{staticClass:"fp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"fp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-medium"},[""==e.pushFHImages.face[e.image_count/2+e.image_count+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.face[e.image_count/2+e.image_count+t-1].src?n("img",{staticClass:"image-medium",attrs:{src:e.pushFHImages.face[e.image_count/2+e.image_count+t-1].src},on:{click:function(n){return e.look(e.pushFHImages.face[e.image_count/2+e.image_count+t-1])}}}):e._e()])])})),1)],1),n("el-row",{staticClass:"img_list"},[n("el-col",{staticClass:"fp_img_col",attrs:{span:2}},[n("div",{staticClass:"type_text_fh"},[e._v("人形")])]),n("el-col",{staticClass:"fp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"fp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-medium"},[""==e.pushFHImages.body[t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.body[t-1].src?n("img",{staticClass:"image-medium",attrs:{src:e.pushFHImages.body[t-1].src},on:{click:function(n){return e.look(e.pushFHImages.body[t-1])}}}):e._e()])])})),1),n("el-col",{staticClass:"fp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"fp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-medium"},[""==e.pushFHImages.body[e.image_count/2+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.body[e.image_count/2+t-1].src?n("img",{staticClass:"image-medium",attrs:{src:e.pushFHImages.body[e.image_count/2+t-1].src},on:{click:function(n){return e.look(e.pushFHImages.body[e.image_count/2+t-1])}}}):e._e()])])})),1)],1),n("el-row",{staticClass:"img_list_bottom"},[n("el-col",{staticClass:"fp_img_col",attrs:{span:2}},[n("div",{staticClass:"type_text_fh"},[e._v("人形")])]),n("el-col",{staticClass:"fp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"fp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-medium"},[""==e.pushFHImages.body[e.image_count+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.body[e.image_count+t-1].src?n("img",{staticClass:"image-medium",attrs:{src:e.pushFHImages.body[e.image_count+t-1].src},on:{click:function(n){return e.look(e.pushFHImages.body[e.image_count+t-1])}}}):e._e()])])})),1),n("el-col",{staticClass:"fp_img_col",attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"fp_img_col",attrs:{span:3}},[n("div",{staticClass:"image-medium"},[""==e.pushFHImages.body[e.image_count/2+e.image_count+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.body[e.image_count/2+e.image_count+t-1].src?n("img",{staticClass:"image-medium",attrs:{src:e.pushFHImages.body[e.image_count/2+e.image_count+t-1].src},on:{click:function(n){return e.look(e.pushFHImages.body[e.image_count/2+e.image_count+t-1])}}}):e._e()])])})),1)],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showViewer,expression:"showViewer"}],staticClass:"view_container"},[n("el-dialog",{attrs:{visible:e.showViewer,width:"800px","before-close":e.handleViewerClose},on:{"update:visible":function(t){e.showViewer=t}}},[n("span",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.image_types[e.viewerImg.type]+"详细信息-"+e.viewerImg.date)+" ")]),n("el-row",{staticClass:"view_image_info_container"},[n("el-col",{staticClass:"view_image_col",attrs:{span:12}},[n("el-image",{staticClass:"image-view",attrs:{src:e.viewerImg.src,"preview-src-list":[e.viewerImg.src],fit:"fill"}},[n("div",{staticClass:"image-slot-large",attrs:{slot:"error"},slot:"error"},[n("i",{staticClass:"el-icon-picture-outline"})])])],1),n("el-col",{staticClass:"info_col",attrs:{span:12}},[n("div",{staticClass:"view_info_container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:3==e.viewerImg.type&&"facehuman"==e.detect_mode,expression:"viewerImg.type == 3 && detect_mode == 'facehuman'"}],staticClass:"view_info_text"},[e._v(" 性别： "+e._s(e.viewerImg.info.gender)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:3==e.viewerImg.type&&"facehuman"==e.detect_mode,expression:"viewerImg.type == 3 && detect_mode == 'facehuman'"}],staticClass:"view_info_text"},[e._v(" 年龄： "+e._s(e.viewerImg.info.age)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:3==e.viewerImg.type&&"facehuman"==e.detect_mode,expression:"viewerImg.type == 3 && detect_mode == 'facehuman'"}],staticClass:"view_info_text"},[e._v(" 口罩： "+e._s(e.viewerImg.info.mask)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:3==e.viewerImg.type&&"facehuman"==e.detect_mode,expression:"viewerImg.type == 3 && detect_mode == 'facehuman'"}],staticClass:"view_info_text"},[e._v(" 识别： "+e._s(e.viewerImg.info.info)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:4==e.viewerImg.type&&"hvcfp"==e.detect_mode,expression:"viewerImg.type == 4 && detect_mode == 'hvcfp'"}],staticClass:"view_info_text"},[e._v(" 车牌号码："+e._s(e.viewerImg.info.number)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:4==e.viewerImg.type&&"hvcfp"==e.detect_mode,expression:"viewerImg.type == 4 && detect_mode == 'hvcfp'"}],staticClass:"view_info_text"},[e._v(" 车牌颜色："+e._s(e.viewerImg.info.color)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:"facehuman"==e.detect_mode&&3!=e.viewerImg.type||"hvcfp"==e.detect_mode&&4!=e.viewerImg.type,expression:"detect_mode == 'facehuman' && viewerImg.type != 3 || detect_mode == 'hvcfp' && viewerImg.type !=4"}],staticClass:"view_info_text"},[e._v(" 无属性信息 ")])])])],1)],1)],1)],1)],1)},i=[],a=n("1da1"),o=(n("a9e3"),n("a4d3"),n("e01a"),n("a434"),n("d3b7"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("fb6a"),n("96cf"),n("d022")),s=n.n(o),c=n("93bf"),u=n.n(c),l=n("21a6"),f={props:["mode_option"],data:function(){return{image_count:16,detect_mode:"hvcfp",pushFHImages:{face:[],body:[]},pushHCVFPImages:{face:[],body:[],vechicle:[],cycle:[],plate:[]},currentImg:{type:0,src:"",date:"",info:{age:"--",gender:"--",mask:"--",info:"--",number:"--",color:"--"}},viewerImg:{type:0,src:"",date:"",info:{age:"--",gender:"--",mask:"--",info:"--",number:"--",color:"--"}},eventList:[],image_types:["人形","机动车","非机动车","人脸","车牌"],sizeOptions:[{id:0,label:"自适应",value:"0:0",icon:"el-icon-full-screen"},{id:1,label:"原比例",value:"1:1",icon:"el-icon-full-screen"}],srcOptions:[{id:0,label:"视频源0",icon:"el-icon-full-screen"},{id:1,label:"视频源1",icon:"el-icon-full-screen"}],streamOptions:[{id:0,label:"主码流0",icon:"el-icon-full-screen"},{id:1,label:"子码流1",icon:"el-icon-full-screen"}],genderOptions:["女","男"],respiratorOptions:{no_respirator:"未戴口罩",surgical:"医用口罩","anti-pollution":"防雾霾口罩",common:"普通口罩",kitchen_transparent:"厨房透明口罩",unknown:"未知"},plateColorOptions:{blue:"蓝色",yellow:"黄色",black:"黑色",white:"白色",green:"绿色",small_new_energy:"新能源",large_new_energy:"新能源",absence:"未知",unknown:"未知"},screenIcon:"vjs-icon-fullscreen-enter",sizeOptionInd:1,srcOptionInd:0,streamOptionInd:1,rec_enable:!0,isAiEnable:!1,isSearchImg:!1,isFullScreen:!1,isRecStart:!1,isError:!1,wfsObj:null,isForceStop:!1,wsCapture:[null,null],wsEvents:null,timer_capture:[void 0,void 0],timerEvents:void 0,lastRecvDataTime:[0,0],curImgInd:{fh:[0,0],hcvfp:[0,0,0,0,0]},max_try_num:3,enc_info:"",timer_enc_info:void 0,showViewer:!1,timerTest:null,curInd:0,curListInd:0}},created:function(){console.log("preview created ++"),this.getInfo();var e=window.localStorage.getItem("stream");this.streamOptionInd="0"===e?0:"1"===e?1:"2"===e?2:1,e=window.localStorage.getItem("src_id"),this.srcOptionInd="1"===e?1:0,e=window.localStorage.getItem("size"),this.sizeOptionInd="1"===e?1:0;for(var t=0;t<this.image_count;t++)this.pushFHImages.face.push({type:3,src:"",date:"",info:{gender:"--",age:"--",mask:"--",info:"--"}}),this.pushFHImages.face.push({type:3,src:"",date:"",info:{gender:"--",age:"--",mask:"--",info:"--"}}),this.pushFHImages.body.push({type:0,src:"",date:"",info:{}}),this.pushFHImages.body.push({type:0,src:"",date:"",info:{}}),this.pushHCVFPImages.face.push({type:3,src:"",date:"",info:{}}),this.pushHCVFPImages.body.push({type:0,src:"",date:"",info:{}}),this.pushHCVFPImages.vechicle.push({type:1,src:"",date:"",info:{}}),this.pushHCVFPImages.cycle.push({type:2,src:"",date:"",info:{}}),this.pushHCVFPImages.plate.push({type:4,src:"",date:"",info:{number:"--",color:"--"}});if(!document.getElementById("converterScript")){var n=document.createElement("script");n.setAttribute("src","js/wasmconverter.js"),n.setAttribute("type","text/javascript"),n.setAttribute("id","converterScript"),document.head.appendChild(n)}console.log("preview created --")},mounted:function(){console.log("preview mounted ++");var e=this;u.a.isEnabled&&u.a.on("change",(function(){e.checkFull()})),this.startMedia(),console.log("preview mounted --")},destroyed:function(){this.stopMedia()},methods:{wasmConvertImage:function(e){var t=0,n=1,r=Module.convertImage(e,e.length,t,n);return r},startMedia:function(){this.startPlay(),this.startCapture(0),this.startCapture(1),this.startRecvEvents()},stopMedia:function(){this.isForceStop=!0,this.stopEncInfoQuery(),this.stop(),this.stopCatpure(0),this.stopCatpure(1),this.stopRecvEvents(),u.a.off("change",(function(){}))},startPlay:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=!1,r=0;case 2:if(!(r<e.max_try_num)){t.next=19;break}if(!n){t.next=5;break}return t.abrupt("break",19);case 5:return t.prev=5,t.next=8,e.changeStream(e.streamOptionInd+"",!1,!1);case 8:e.play(),n=!0,t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](5),n=!1,r==e.max_try_num-1&&console.log("startPlay catch except: "+t.t0);case 16:r++,t.next=2;break;case 19:n||e.$message.error("网络请求码流失败");case 20:case"end":return t.stop()}}),t,null,[[5,12]])})))()},play:function(){var e=this;console.log("play ++");try{this.stop(),this.changeSizeOption(this.sizeOptionInd+"");var t=window.sessionStorage.getItem("token"),n=document.getElementById("myVideo"),r=n,i="H264Raw";if(s.a.isSupported()){var a={wsMinPacketInterval:2e3,wsMaxPacketInterval:8e3};this.wfsObj=new s.a(a),this.wfsObj.attachMedia(r,"ch1",i,"ws/preview?token="+t),this.wfsObj.on(s.a.Events.ERROR,(function(t,n){return e.handleWfsEvent(t,n)})),this.isRecStart&&(this.isRecStart=!1,this.onRecording()),this.startEncInfoQuery()}else console.log("wfs is not supported")}catch(o){console.log("play catch except: "+o)}console.log("play --")},stop:function(){console.log("stop ++"),null!=this.wfsObj&&(this.isRecStart&&(this.wfsObj.stop_recording(),this.isError||(this.isRecStart=!1)),this.wfsObj.destroy(),this.wfsObj=null),console.log("stop --")},changeSizeOption:function(e){this.sizeOptionInd=Number(e),0===this.sizeOptionInd?document.getElementById("myVideo").style.setProperty("object-fit","fill","important"):document.getElementById("myVideo").style.setProperty("object-fit","contain","important"),console.log("old objectFit: ",document.getElementById("myVideo").style.objectFit),window.localStorage.setItem("size",this.sizeOptionInd)},changeStream:function(e){var t=arguments,n=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var i,a,o,s,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return i=!(t.length>1&&void 0!==t[1])||t[1],a=!(t.length>2&&void 0!==t[2])||t[2],o=Number(e),console.log("change stream to "+n.streamOptions[o].id),r.next=6,n.$http.post("preview/stream",{src:n.srcOptions[n.srcOptionInd].id,stream:n.streamOptions[o].id});case 6:if(s=r.sent,c=s.data,console.log("post stream return: ",c),c&&200===c.meta.status){r.next=11;break}return r.abrupt("return",n.$message.error("设置码流失败"));case 11:a&&(n.streamOptionInd=o,window.localStorage.setItem("src_id",n.srcOptions[n.srcOptionInd].id),window.localStorage.setItem("stream",n.streamOptions[o].id)),i&&n.play(),n.clearEncInfo();case 14:case"end":return r.stop()}}),r)})))()},recordFaceinfo:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("record faceinfo"),e.stop(),t.next=4,e.$http.post("preview/faceinfo",{faceinfo:!0});case 4:if(n=t.sent,r=n.data,e.play(),console.log("post record faceinfo: ",r),200===r.meta.status){t.next=12;break}return t.abrupt("return",e.$message.error("人像信息录入失败"));case 12:if(0!=r.data.faceinfo.status){t.next=16;break}return t.abrupt("return",e.$message.success("人像信息录入成功"));case 16:if(2!=r.data.faceinfo.status){t.next=20;break}return t.abrupt("return",e.$message.warning("不支持此功能"));case 20:if(3!=r.data.faceinfo.status){t.next=24;break}return t.abrupt("return",e.$message.warning("数据加载中，请稍后再试"));case 24:return t.abrupt("return",e.$message.error("人像信息录入失败，请重试"));case 25:case"end":return t.stop()}}),t)})))()},getInfo:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("preview/info");case 3:n=t.sent,r=n.data,console.log("preview info get return: ",r),200===r.meta.status&&(e.isSearchImg=r.data.info.searchimg,e.isAiEnable=r.data.info.ai_enable,e.detect_mode=r.data.info.detect_mode,console.log("detect_mode: "+e.detect_mode),e.detect_mode||(e.detect_mode="facehuman",console.log("set detect_mode to default: "+e.detect_mode))),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),e.$message.error("获取信息失败");case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},rec_result_cb:function(e){this.rec_enable=!0,e?this.isRecStart=!0:this.$message.error("开启录像失败")},rec_state_cb:function(e){this.rec_enable=e},onSnapshot:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("preview/snapshot");case 3:n=t.sent,r=n.data,200===r.meta.status&&console.log("send snapshot cmd succ"),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.$message.error("发送命令失败");case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},onRecording:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.wfsObj&&(e.isRecStart?(e.wfsObj.stop_recording(),e.isRecStart=!1):(e.rec_enable=!1,n=window.localStorage.getItem("rec_threshold_web"),void 0==n&&(n=1024),console.log("recording - threshold: "+n+" MB"),e.wfsObj.start_recording(1024*n*1024,e.rec_result_cb,e.rec_state_cb)));case 1:case"end":return t.stop()}}),t)})))()},getEncInfo:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("preview/assist");case 3:n=t.sent,r=n.data,console.log("preview enc info get return: ",r),200===r.meta.status&&(e.enc_info="分辨率: "+r.data.assist_res+"        码率: "+r.data.assist_bitrate),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),e.$message.error("获取信息失败");case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},clearEncInfo:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.enc_info="";case 1:case"end":return t.stop()}}),t)})))()},startEncInfoQuery:function(){var e=this;this.stopEncInfoQuery(),this.timer_enc_info=setInterval((function(){e.getEncInfo()}),1e3)},stopEncInfoQuery:function(){this.timer_enc_info&&(clearInterval(this.timer_enc_info),this.timer_enc_info=void 0)},doScreen:function(){var e=document.getElementsByClassName("preview_container")[0];this.isFullScreen?(u.a.exit(e),this.screenIcon="vjs-icon-fullscreen-enter"):(u.a.request(e),this.screenIcon="vjs-icon-fullscreen-exit"),this.isFullScreen=!this.isFullScreen},checkFull:function(){u.a.isFullscreen||(this.isFullScreen=!1,this.screenIcon="vjs-icon-fullscreen-enter")},scaleVideoTo16vs9:function(){var e=document.getElementById("myVideo");console.log("videoRatio:"+e.videoWidth+"/"+e.videoHeight)},handleWfsEvent:function(e,t){try{if(t.fatal){switch(this.isError=!0,console.warn("Fatal error :"+t.details),t.type){case s.a.ErrorTypes.MEDIA_ERROR:console.log("a media error occurred");break;case s.a.ErrorTypes.NETWORK_ERROR:console.log("a network error occurred");break;default:console.log("an unrecoverable error occurred");break}this.play()}}catch(n){console.log("handleWfsEvent catch except: "+n.description)}},startCapture:function(e){var t=this;this.stopCatpure(e);var n=window.sessionStorage.getItem("token"),r="ws://"+window.location.host+"/ws/capture_"+e+"?token="+n,i="binary";this.wsCapture[e]=new WebSocket(r,i),this.wsCapture[e].onopen=function(){console.log("ws_"+e+" capture connected"),t.create_capture_timer(e)},this.wsCapture[e].onclose=function(n){console.log("ws_"+e+" capture disconnected",n),t.isForceStop||t.startCapture(e)},this.wsCapture[e].onmessage=function(n){if("string"===typeof n.data)console.log("got a wscapture message: "+n.data);else try{if(t.lastRecvDataTime[e]=performance.now(),0===e){var r=new FileReader;r.onload=function(e){e.target.readyState===FileReader.DONE&&t.parseJpgDataWithHead(e.target.result)},r.readAsArrayBuffer(n.data)}else if(1===e){var i=new Blob([n.data],{type:"image/jpeg"}),a="snapshot_"+t.getCurrentTime()+".jpg";Object(l["saveAs"])(i,a)}}catch(o){console.log("capture image catch except: "+o)}},this.wsCapture[e].onerror=function(t){console.log("ws_"+e+" capture occure error",t)}},stopCatpure:function(e){this.clear_capture_timer(e),this.wsCapture[e]&&this.wsCapture[e].close()},create_capture_timer:function(e){var t=this;this.clear_capture_timer(e),this.timer_capture[e]=setInterval((function(){t.wsCapture[e]&&t.wsCapture[e].send("keep-alive")}),3e3)},clear_capture_timer:function(e){this.timer_capture[e]&&(clearInterval(this.timer_capture[e]),this.timer_capture[e]=void 0)},startRecvEvents:function(){var e=this;console.log("startRecvEvents ++"),this.stopRecvEvents();var t=window.sessionStorage.getItem("token"),n="ws://"+window.location.host+"/ws/events?token="+t,r="binary";this.wsEvents=new WebSocket(n,r),this.wsEvents.onopen=function(){console.log("ws events connected"),e.createEventstimer()},this.wsEvents.onclose=function(t){console.log("ws events disconnected",t),e.isForceStop||e.startRecvEvents()},this.wsEvents.onmessage=function(t){if("string"===typeof t.data)console.log("got a ws events message: "+t.data);else try{var n=new FileReader;n.onload=function(t){if(t.target.readyState===FileReader.DONE){console.log("got a event: "+t.target.result);for(var n=JSON.parse(t.target.result),r=0;r<n.events.length;r++)0===n.events[r].type?e.eventList.unshift({type:"移动",date:n.events[r].date}):1===n.events[r].type&&e.eventList.unshift({type:"遮挡",date:n.events[r].date});e.eventList.length>32&&e.eventList.splice(32,e.eventList.length-32)}},n.readAsText(t.data)}catch(r){console.log("ws events catch except: "+r)}},this.wsEvents.onerror=function(e){console.log("ws events occure error",e)},console.log("startRecvEvents --")},stopRecvEvents:function(){console.log("stopRecvEvents ++"),this.clearEventstimer(),this.wsEvents&&this.wsEvents.close(),console.log("stopRecvEvents --")},createEventstimer:function(){var e=this;this.clearEventstimer(),this.timerEvents=setInterval((function(){e.wsEvents&&e.wsEvents.send("keep-alive")}),3e3)},clearEventstimer:function(){this.timerEvents&&(clearInterval(this.timerEvents),this.timerEvents=void 0)},parseJpgDataWithHead:function(e){try{var t=new Uint8Array(e.slice(0,16));if(t&&65===t[0]&&88===t[1]&&73===t[2]&&84===t[3]){var n=this.bytesToIntLittleEndian(t.subarray(4,8));if(74===t[8]&&83===t[9]&&79===t[10]&&78===t[11]){var r=this.bytesToIntLittleEndian(t.subarray(12,16)),i=new TextDecoder("utf-8"),a=new Uint8Array(e.slice(16,16+r-1)),o=i.decode(a);console.log("jpg info:"+o);var s=JSON.parse(o),c=e.slice(n),u=this.wasmConvertImage(new Uint8Array(c)),l=btoa(new Uint8Array(u).reduce((function(e,t){return e+String.fromCharCode(t)}),"")),f="data:image/png;base64,"+l;if(s&&f)if("facehuman"===this.detect_mode){if(3===s.type){var d=this.curImgInd.fh[0];this.pushFHImages.face[d].src=f,this.pushFHImages.face[d].date=this.getCurrentTime(),this.pushFHImages.face[d].info.gender=this.genderOptions[s.attribute.face.gender],this.pushFHImages.face[d].info.age=s.attribute.face.age,this.pushFHImages.face[d].info.mask=this.respiratorOptions[s.attribute.face.mask],this.pushFHImages.face[d].info.info=s.attribute.face.info,this.curImgInd.fh[0]=(d+1)%this.pushFHImages.face.length,this.currentImg.src=f,this.currentImg.type=3,this.currentImg.date=this.pushFHImages.face[d].date,this.currentImg.info.gender=this.pushFHImages.face[d].info.gender,this.currentImg.info.age=this.pushFHImages.face[d].info.age,this.currentImg.info.mask=this.pushFHImages.face[d].info.mask,this.currentImg.info.info=this.pushFHImages.face[d].info.info}else if(0===s.type){d=this.curImgInd.fh[1];this.pushFHImages.body[d].src=f,this.pushFHImages.body[d].date=this.getCurrentTime(),this.pushFHImages.face[d].info={},this.curImgInd.fh[1]=(d+1)%this.pushFHImages.body.length}}else if(3===s.type){d=this.curImgInd.hcvfp[0];this.pushHCVFPImages.face[d].src=f,this.pushHCVFPImages.face[d].date=this.getCurrentTime(),this.pushHCVFPImages.face[d].info={},this.curImgInd.hcvfp[0]=(d+1)%this.pushHCVFPImages.face.length}else if(0===s.type){d=this.curImgInd.hcvfp[1];this.pushHCVFPImages.body[d].src=f,this.pushHCVFPImages.body[d].date=this.getCurrentTime(),this.pushHCVFPImages.body[d].info={},this.curImgInd.hcvfp[1]=(d+1)%this.pushHCVFPImages.body.length}else if(1===s.type){d=this.curImgInd.hcvfp[2];this.pushHCVFPImages.vechicle[d].src=f,this.pushHCVFPImages.vechicle[d].date=this.getCurrentTime(),this.pushHCVFPImages.vechicle[d].info={},this.curImgInd.hcvfp[2]=(d+1)%this.pushHCVFPImages.vechicle.length}else if(2===s.type){d=this.curImgInd.hcvfp[3];this.pushHCVFPImages.cycle[d].src=f,this.pushHCVFPImages.cycle[d].date=this.getCurrentTime(),this.pushHCVFPImages.cycle[d].info={},this.curImgInd.hcvfp[3]=(d+1)%this.pushHCVFPImages.cycle.length}else if(4===s.type){d=this.curImgInd.hcvfp[4];this.pushHCVFPImages.plate[d].src=f,this.pushHCVFPImages.plate[d].date=this.getCurrentTime(),this.pushHCVFPImages.plate[d].info.number=s.attribute.plate.num,this.pushHCVFPImages.plate[d].info.color=this.plateColorOptions[s.attribute.plate.color],this.curImgInd.hcvfp[4]=(d+1)%this.pushHCVFPImages.plate.length,this.currentImg.src=f,this.currentImg.type=4,this.currentImg.date=this.pushHCVFPImages.plate[d].date,this.currentImg.info.number=this.pushHCVFPImages.plate[d].info.number,this.currentImg.info.color=this.pushHCVFPImages.plate[d].info.color}}}}catch(p){console.log("ws parse jpg with header catch except: "+p)}},getCurrentTime:function(){var e=new Date,t=this.zeroFill(e.getMonth()+1),n=this.zeroFill(e.getDate()),r=this.zeroFill(e.getHours()),i=this.zeroFill(e.getMinutes()),a=this.zeroFill(e.getSeconds()),o=e.getMilliseconds();o<=9?o="00"+o:o<=99&&(o="0"+o);var s=e.getFullYear()+"-"+t+"-"+n+" "+r+":"+i+":"+a+"."+o;return s},zeroFill:function(e){return e>=0&&e<=9?"0"+e:e},bytesToIntLittleEndian:function(e){for(var t=0,n=e.length-1;n>=0;n--)t+=e[n],0!=n&&(t<<=8);return t},handleViewerClose:function(){this.showViewer=!1},look:function(e){("facehuman"===this.detect_mode&&3===e.type||"hvcfp"===this.detect_mode&&4===e.type)&&(this.currentImg.type=e.type,this.currentImg.src=e.src,this.currentImg.date=e.date,this.currentImg.info.age=e.info.age,this.currentImg.info.gender=e.info.gender,this.currentImg.info.mask=e.info.mask,this.currentImg.info.info=e.info.info,this.currentImg.info.number=e.info.number,this.currentImg.info.color=e.info.color),this.viewerImg.type=e.type,this.viewerImg.src=e.src,this.viewerImg.date=e.date,this.viewerImg.info.age=e.info.age,this.viewerImg.info.gender=e.info.gender,this.viewerImg.info.mask=e.info.mask,this.viewerImg.info.info=e.info.info,this.viewerImg.info.number=e.info.number,this.viewerImg.info.color=e.info.color,this.showViewer=!0}}},d=f,p=(n("64d1"),n("2877")),h=Object(p["a"])(d,r,i,!1,null,"67b92c75",null);t["default"]=h.exports},e91f:function(e,t,n){"use strict";var r=n("ebb5"),i=n("4d64").indexOf,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("indexOf",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0)}))},eac5:function(e,t,n){var r=n("861d"),i=Math.floor;e.exports=Number.isInteger||function(e){return!r(e)&&isFinite(e)&&i(e)===e}},ebb5:function(e,t,n){"use strict";var r,i,a,o=n("a981"),s=n("83ab"),c=n("da84"),u=n("1626"),l=n("861d"),f=n("1a2d"),d=n("f5df"),p=n("0d51"),h=n("9112"),m=n("6eeb"),y=n("9bf2").f,g=n("3a9b"),v=n("e163"),b=n("d2bb"),_=n("b622"),w=n("90e3"),E=c.Int8Array,C=E&&E.prototype,T=c.Uint8ClampedArray,S=T&&T.prototype,I=E&&v(E),k=C&&v(C),A=Object.prototype,R=c.TypeError,x=_("toStringTag"),O=w("TYPED_ARRAY_TAG"),F=w("TYPED_ARRAY_CONSTRUCTOR"),P=o&&!!b&&"Opera"!==d(c.opera),D=!1,U={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},L={BigInt64Array:8,BigUint64Array:8},M=function(e){if(!l(e))return!1;var t=d(e);return"DataView"===t||f(U,t)||f(L,t)},N=function(e){if(!l(e))return!1;var t=d(e);return f(U,t)||f(L,t)},B=function(e){if(N(e))return e;throw R("Target is not a typed array")},H=function(e){if(u(e)&&(!b||g(I,e)))return e;throw R(p(e)+" is not a typed array constructor")},j=function(e,t,n){if(s){if(n)for(var r in U){var i=c[r];if(i&&f(i.prototype,e))try{delete i.prototype[e]}catch(a){}}k[e]&&!n||m(k,e,n?t:P&&C[e]||t)}},V=function(e,t,n){var r,i;if(s){if(b){if(n)for(r in U)if(i=c[r],i&&f(i,e))try{delete i[e]}catch(a){}if(I[e]&&!n)return;try{return m(I,e,n?t:P&&I[e]||t)}catch(a){}}for(r in U)i=c[r],!i||i[e]&&!n||m(i,e,t)}};for(r in U)i=c[r],a=i&&i.prototype,a?h(a,F,i):P=!1;for(r in L)i=c[r],a=i&&i.prototype,a&&h(a,F,i);if((!P||!u(I)||I===Function.prototype)&&(I=function(){throw R("Incorrect invocation")},P))for(r in U)c[r]&&b(c[r],I);if((!P||!k||k===A)&&(k=I.prototype,P))for(r in U)c[r]&&b(c[r].prototype,k);if(P&&v(S)!==k&&b(S,k),s&&!f(k,x))for(r in D=!0,y(k,x,{get:function(){return l(this)?this[O]:void 0}}),U)c[r]&&h(c[r],O,r);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:P,TYPED_ARRAY_CONSTRUCTOR:F,TYPED_ARRAY_TAG:D&&O,aTypedArray:B,aTypedArrayConstructor:H,exportTypedArrayMethod:j,exportTypedArrayStaticMethod:V,isView:M,isTypedArray:N,TypedArray:I,TypedArrayPrototype:k}},f8cd:function(e,t,n){var r=n("da84"),i=n("5926"),a=r.RangeError;e.exports=function(e){var t=i(e);if(t<0)throw a("The argument can't be less than 0");return t}}}]);